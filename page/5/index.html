<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.2.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"yanni4night.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="人过不留名 雁过不留声">
<meta property="og:url" content="https://yanni4night.github.io/page/5/index.html">
<meta property="og:site_name" content="人过不留名 雁过不留声">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Yanni4night">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://yanni4night.github.io/page/5/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/5/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>人过不留名 雁过不留声</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-SVVTY641FP"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-SVVTY641FP","only_pageview":false,"measure_protocol_api_secret":null}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>

  <script src="/js/third-party/analytics/baidu-analytics.js"></script>
  <script async src="https://hm.baidu.com/hm.js?102a03a6de835cd378834b32e2639fbe"></script>







  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">人过不留名 雁过不留声</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">夜莺</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Yanni4night"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Yanni4night</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">74</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">30</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/yanni4night" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yanni4night" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:yanni4night@gmail.com" title="E-Mail → mailto:yanni4night@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yanni4night.github.io/2016/03/28/2016-03-28-missing-right-margin/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Yanni4night">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="人过不留名 雁过不留声">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 人过不留名 雁过不留声">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2016/03/28/2016-03-28-missing-right-margin/" class="post-title-link" itemprop="url">滚动区内消失的右边距</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2016-03-28 17:13:57" itemprop="dateCreated datePublished" datetime="2016-03-28T17:13:57+08:00">2016-03-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-07-13 02:12:59" itemprop="dateModified" datetime="2025-07-13T02:12:59+08:00">2025-07-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/css/" itemprop="url" rel="index"><span itemprop="name">css</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2016/03/28/2016-03-28-missing-right-margin/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/03/28/2016-03-28-missing-right-margin/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>观察<a href="/example/miss-right-margin.html">这个</a>页面，在可滚动区域内部，为 <em>.content</em> 元素定义的右边距消失了。</p>
<p><img src="/images/missing-right-margin/missing.jpg" alt="Missing Right Margin"></p>
<p>StackOverflow 上有关于这个现象的详细<a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/11695354/css-right-margin-does-not-work-inside-a-div-with-overflow-scroll">解释</a>，简单来讲这就是 CSS 这么<a target="_blank" rel="noopener" href="https://www.w3.org/TR/CSS21/visudet.html#blockwidth">要求</a>的。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/03/28/2016-03-28-missing-right-margin/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yanni4night.github.io/2016/03/24/2016-03-24-cssom-view-module/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Yanni4night">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="人过不留名 雁过不留声">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 人过不留名 雁过不留声">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2016/03/24/2016-03-24-cssom-view-module/" class="post-title-link" itemprop="url">CSSOM View Module 中的尺寸与位置属性</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2016-03-24 00:40:22" itemprop="dateCreated datePublished" datetime="2016-03-24T00:40:22+08:00">2016-03-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-07-13 02:12:59" itemprop="dateModified" datetime="2025-07-13T02:12:59+08:00">2025-07-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/css/" itemprop="url" rel="index"><span itemprop="name">css</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2016/03/24/2016-03-24-cssom-view-module/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/03/24/2016-03-24-cssom-view-module/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><code>CSSOM</code> 指 _CSS Object Model_，即 _CSS对象模型_。CSSOM 是 JavaScript 操纵 CSS 的一系列 API 集合，它属是 DOM 和 HTML API 的附属。</p>
<p>其中视图模型（View Model）中定义了一系列接口，包括多个关于窗体、文档和元素的位置尺寸信息，特别容易混淆。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/03/24/2016-03-24-cssom-view-module/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yanni4night.github.io/2016/03/13/2016-03-13-redux-define-actions/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Yanni4night">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="人过不留名 雁过不留声">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 人过不留名 雁过不留声">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2016/03/13/2016-03-13-redux-define-actions/" class="post-title-link" itemprop="url">如何定义 redux 的 action</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2016-03-13 23:02:38" itemprop="dateCreated datePublished" datetime="2016-03-13T23:02:38+08:00">2016-03-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-07-13 02:12:59" itemprop="dateModified" datetime="2025-07-13T02:12:59+08:00">2025-07-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/js/" itemprop="url" rel="index"><span itemprop="name">js</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2016/03/13/2016-03-13-redux-define-actions/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/03/13/2016-03-13-redux-define-actions/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>虽然 redux 的模型非常简单，但如何对其理解不深，在实际的业务研发中很容易迷失，比如会纠结该如何定义枚举的 <code>Action Type</code>。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/03/13/2016-03-13-redux-define-actions/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yanni4night.github.io/2016/03/10/2016-03-10-redux-black-magic/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Yanni4night">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="人过不留名 雁过不留声">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 人过不留名 雁过不留声">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2016/03/10/2016-03-10-redux-black-magic/" class="post-title-link" itemprop="url">Redux 的黑魔法</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2016-03-10 15:45:10" itemprop="dateCreated datePublished" datetime="2016-03-10T15:45:10+08:00">2016-03-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-07-13 02:12:59" itemprop="dateModified" datetime="2025-07-13T02:12:59+08:00">2025-07-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/js/" itemprop="url" rel="index"><span itemprop="name">js</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2016/03/10/2016-03-10-redux-black-magic/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/03/10/2016-03-10-redux-black-magic/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>相信很多人接触 <a target="_blank" rel="noopener" href="https://github.com/reactjs/redux">Redux</a> 时都会被它奇怪的 API 搞得云里雾里。这里不再冗述 Flux 架构的思想，实现 Flux 的工具有很多，它们只是在实现这种编程模式，并不会有太复杂的逻辑。事实也是这样，Redux 的 API 非常少，但并不一定容易理解。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/03/10/2016-03-10-redux-black-magic/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yanni4night.github.io/2016/01/07/2016-01-07-webcomponents/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Yanni4night">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="人过不留名 雁过不留声">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 人过不留名 雁过不留声">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2016/01/07/2016-01-07-webcomponents/" class="post-title-link" itemprop="url">Webcomponents</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2016-01-07 16:44:15" itemprop="dateCreated datePublished" datetime="2016-01-07T16:44:15+08:00">2016-01-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-07-13 02:12:59" itemprop="dateModified" datetime="2025-07-13T02:12:59+08:00">2025-07-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/webcomponents/" itemprop="url" rel="index"><span itemprop="name">webcomponents</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2016/01/07/2016-01-07-webcomponents/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/01/07/2016-01-07-webcomponents/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><code>Webcomponents</code> 草案包含四个特性：</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://w3c.github.io/webcomponents/spec/custom/">Custom Elements</a></li>
<li><a target="_blank" rel="noopener" href="http://w3c.github.io/webcomponents/spec/imports/">HTML Imports</a></li>
<li><a target="_blank" rel="noopener" href="https://html.spec.whatwg.org/multipage/scripting.html#the-template-element">Templates</a></li>
<li><a target="_blank" rel="noopener" href="http://w3c.github.io/webcomponents/spec/shadow/">Shadow DOM</a></li>
</ul>
<p>具体每个特性的意义不再冗述，网上到处都有，但对四个特性之间的联系及应用普遍缺少更深入的解释。</p>
<h2 id="关联"><a href="#关联" class="headerlink" title="关联"></a>关联</h2><p><code>Webcomponents</code> 的名字立即会让人想起组件化，有观点认为 <code>Custom Elements</code> 与 <code>HTML Imports</code> 是主要部分，<code>Templates</code> 与 <code>Shadow DOM</code> 是次要部分，毕竟，传统的组件系统就是由组件依赖以及组件内容构成的。甚至有人经常把 <code>Custom Elements</code> 与 <code>HTML Imports</code> 绑定在一起，认为 <code>Custom Elements</code> 都是 <em>import</em> 进来的。</p>
<p>以上观点肯定是错误的，可能由于 <code>Webcomponents</code> 还在草案之中，文档不全，造成误解也难怪。</p>
<p>先来看 <code>Custom Elements</code>，如何注册一个自定义元素？是这样么：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;import&quot;</span> <span class="attr">href</span>=<span class="string">&quot;wc-rank.html&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">wc-rank</span>&gt;</span><span class="tag">&lt;/<span class="name">wc-rank</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>不是，如果是，就证明了 <code>Custom Elements</code> 都是 <em>import</em> 进来的观点了。</p>
<p>自定义元素需要通过 JavaScript 脚本来注册：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">registerElement</span>(<span class="string">&#x27;x-rank&#x27;</span>, options)</span><br></pre></td></tr></table></figure>

<p>使用没有注册过的自定义元素通常也不会有问题，不过它只能代表其后代元素的意义，本身并没有语义。一般地，我们会通过定义 <strong>options</strong> 参数来扩展 DOM 元素的方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">RankElement</span> = <span class="variable language_">document</span>.<span class="title function_">registerElement</span>(<span class="string">&#x27;x-rank&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">prototype</span>: &#123;</span><br><span class="line">        <span class="attr">next</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> $fooRank = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#foo-rank&#x27;</span>);</span><br><span class="line"></span><br><span class="line">$fooRank.<span class="title function_">next</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在这种场景下，<code>registerElement</code> 就是必须的了。因此，在不支持 <code>Custom Elements</code> 的浏览器上，polyfill 是不可能完全实现的。</p>
<p>好了，现在我们实现的 <code>Custom Elements</code> 已经有了自定义方法，但还可能需要在内部添加一些固定的后代元素，比如，对于一个 Article 来讲，Header，Footer 就是固定的后代元素，而 Summary 则非。这时候，我们一般使用模板引擎，渲染后直接将 HTML 片段插入到 DOM 中进行解析和展现。<code>Webcomponents</code> 提供了原生的 <em>template</em> 元素，预先解析了这部分 DOM，但并不展现，需要时，取出其后代元素的集合（DocumentFragment）：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">wc-rank</span> <span class="attr">id</span>=<span class="string">&quot;rank&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">wc-rank</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">header</span>&gt;</span>yanni4night.com<span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">footer</span>&gt;</span><span class="symbol">&amp;copy;</span>copyright yanni4night.com 2014~2016<span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> template = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;template&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(template.<span class="property">content</span> <span class="keyword">instanceof</span> <span class="title class_">DocumentFragment</span>) <span class="comment">//true</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#rank&#x27;</span>).<span class="title function_">appendChild</span>(template.<span class="property">content</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果自定义元素在创建时就已经拥有了固定的后代元素呢，该如何实现？</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">wc-rank</span> <span class="attr">id</span>=<span class="string">&quot;rank&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">header</span>&gt;</span>yanni4night.com<span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">footer</span>&gt;</span><span class="symbol">&amp;copy;</span>copyright yanni4night.com 2014~2016<span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">wc-rank</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> template = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;template&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(template.<span class="property">content</span> <span class="keyword">instanceof</span> <span class="title class_">DocumentFragment</span>) <span class="comment">//true</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#rank&#x27;</span>).<span class="title function_">insertBefore</span>(template.<span class="property">content</span>, <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#rank&#x27;</span>).<span class="property">lastChild</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>可见，template 数量增多后会使操作十分麻烦，<code>Shadow DOM</code> 可以解决这个问题：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">wc-rank</span> <span class="attr">id</span>=<span class="string">&quot;rank&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">wc-rank</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">header</span>&gt;</span>yanni4night.com<span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">content</span> <span class="attr">select</span>=<span class="string">&quot;h1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">content</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">footer</span>&gt;</span><span class="symbol">&amp;copy;</span>copyright yanni4night.com 2014~2016<span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> proto = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="title class_">HTMLElement</span>.<span class="property"><span class="keyword">prototype</span></span>);</span></span><br><span class="line"><span class="language-javascript">proto.<span class="property">createdCallback</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> root = <span class="variable language_">this</span>.<span class="title function_">createShadowRoot</span>();</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> template = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;template&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> clone = <span class="variable language_">document</span>.importNode(template.<span class="property">content</span>, <span class="literal">true</span>);</span></span><br><span class="line"><span class="language-javascript">  root.<span class="title function_">appendChild</span>(clone);</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">document</span>.<span class="title function_">registerElement</span>(<span class="string">&#x27;wc-rank&#x27;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">prototype</span>: proto</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这样，便以优雅的方式达到了定义自定义元素以及高效重用的目的。现在，将 <code>Custom Elements</code> 的定义分离出去，维护在单独的文档中，这就是 <code>HTML Imports</code> 的用处之一。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- wc-rank.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">header</span>&gt;</span>yanni4night.com<span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">content</span> <span class="attr">select</span>=<span class="string">&quot;h1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">content</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">footer</span>&gt;</span><span class="symbol">&amp;copy;</span>copyright yanni4night.com 2014~2016<span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> proto = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="title class_">HTMLElement</span>.<span class="property"><span class="keyword">prototype</span></span>);</span></span><br><span class="line"><span class="language-javascript">proto.<span class="property">createdCallback</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> root = <span class="variable language_">this</span>.<span class="title function_">createShadowRoot</span>();</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> template = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;template&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> clone = <span class="variable language_">document</span>.importNode(template.<span class="property">content</span>, <span class="literal">true</span>);</span></span><br><span class="line"><span class="language-javascript">  root.<span class="title function_">appendChild</span>(clone);</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">document</span>.<span class="title function_">registerElement</span>(<span class="string">&#x27;wc-rank&#x27;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">prototype</span>: proto</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- index.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;import&quot;</span> <span class="attr">href</span>=<span class="string">&quot;wc-rank.html&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">wc-rank</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">wc-rank</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如此，四个 <code>Webcomponents</code> 的特性全部有了用武之地：</p>
<blockquote>
<p>(语义)-&gt;<br>Custom Elements<br>(内容)-&gt;<br>Templates<br>(效率)-&gt;<br>Shadow DOM<br>(重用)-&gt;<br>HTML Imports</p>
</blockquote>
<p>它们都可以独立使用，但相互组合，更能实现优雅和高效的组件化。</p>
<p><img src="/images/webcomponents/webcomponents.png"></p>
<h2 id="Polyfill"><a href="#Polyfill" class="headerlink" title="Polyfill"></a>Polyfill</h2><p> 由于目前仅 Chrome（Opera）实现了全部特性，因此 Polyfill 仍有存在一定的价值。下面几个项目都依赖了 <a target="_blank" rel="noopener" href="https://github.com/WebComponents/webcomponentsjs">webcomponentsjs</a>，但在 API 上有所不同。</p>
<h3 id="Polymer"><a href="#Polymer" class="headerlink" title="Polymer"></a>Polymer</h3><p>谷歌发起的项目。Polymer 使用 &lt; dom-module &gt; 标签来定义 <code>Custom Elements</code>：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">&lt;!--Custom element defination--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dom-module</span> <span class="attr">id</span>=<span class="string">&quot;wc-rank&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>I&#x27;m a DOM element. This is my local DOM!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">content</span> <span class="attr">select</span>=<span class="string">&quot;footer&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">content</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Polymer</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">is</span>: <span class="string">&quot;wc-rank&quot;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dom-module</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--Custom element usage--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">wc-rank</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">footer</span>&gt;</span><span class="symbol">&amp;copy;</span>copyright<span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">wc-rank</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>内部同时声明了 <code>Templates</code> ，并使用 <em>shady</em> DOM 来针对不支持 <em>shadow</em> DOM 的浏览器。<code>HTML Imports</code> 也被支持。</p>
<p>值得一提的是，Polymer 支持更复杂的 template，比如 <strong>mustache</strong> 语法及 <em>dom-if_、_dom-repeat</em> 指令，有点类似于 Angular 的 <em>ng-if</em> 和 _ng-repeat_。</p>
<h3 id="X-tag"><a href="#X-tag" class="headerlink" title="X-tag"></a>X-tag</h3><p><a href="x-tag.github.io">X-tag</a> 是微软支持的项目。X-tag 以纯 JavaScript 脚本声明 <code>Custom Elements</code>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">xtag.<span class="title function_">register</span>(<span class="string">&#x27;wc-rank&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">content</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="comment">/*</span></span><br><span class="line"><span class="comment">    ‹h2›My name is rank/h2›</span></span><br><span class="line"><span class="comment">    ‹span›I work for a mad scientist‹/span›</span></span><br><span class="line"><span class="comment">  */</span>&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>X-tag 实现了 <code>Custom elements</code> 的生命周期回调，对 <code>HTML Imports</code>、<code>Templates</code> 和 <code>Shadow DOM</code>  没有明显的支持。</p>
<h3 id="Bosonic"><a href="#Bosonic" class="headerlink" title="Bosonic"></a>Bosonic</h3><p><a target="_blank" rel="noopener" href="http://bosonic.github.io/">Bosonic</a> 旨在构建一套低级的 UI 元素：即拿即用。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">element</span> <span class="attr">name</span>=<span class="string">&quot;wc-rank&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>I&#x27;m Shadow DOM<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">Bosonic</span>.<span class="title function_">register</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">tip</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> span = <span class="variable language_">this</span>.<span class="property">shadowRoot</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;span&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">                span.<span class="property">textContent</span> = <span class="string">&#x27;Hello, world!&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">element</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">wc-rank</span>&gt;</span><span class="tag">&lt;/<span class="name">wc-rank</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;wc-rank&#x27;</span>).<span class="title function_">tip</span>();</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Rosetta"><a href="#Rosetta" class="headerlink" title="Rosetta"></a>Rosetta</h3><p><a target="_blank" rel="noopener" href="http://rosetta-org.github.io/">Rosetta</a> 是百度的一套 <code>Webcomponents</code> 解决方案，与上面三个项目最大的区别是在线下利用构建进行 polyfill，以提高运行时效率。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">element</span> <span class="attr">name</span>=<span class="string">&quot;r-slider&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            &#123;attrs.text&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">content</span> <span class="attr">select</span>=<span class="string">&#x27;.aaa&#x27;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">content</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">Rosetta</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">is</span>: <span class="string">&#x27;r-slider&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">properties</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">list</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">type</span>: <span class="title class_">Array</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">value</span>:[</span></span><br><span class="line"><span class="language-javascript">                        &#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="attr">title</span>: <span class="string">&#x27;111&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                            <span class="attr">src</span>: <span class="string">&#x27;xxx&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                        &#125;,</span></span><br><span class="line"><span class="language-javascript">                        &#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="attr">title</span>: <span class="string">&#x27;222&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                            <span class="attr">src</span>: <span class="string">&#x27;zzz&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                        &#125;</span></span><br><span class="line"><span class="language-javascript">                    ]</span></span><br><span class="line"><span class="language-javascript">                &#125;,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">text</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">type</span>: <span class="title class_">String</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">value</span>: <span class="string">&#x27;测试&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">element</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p> API 与 Polymer 如出一辙。 </p>
<h2 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h2><p>换个角度，<code>Webcomponents</code> 目前在前端生产环境中使用还为时尚早，但其组织方式可以被服务端借鉴。试想，每个组件或者自定义元素都组织在私有的目录下：</p>
<ul>
<li>components<ul>
<li>wc-rank<ul>
<li>wc-rank.html</li>
<li>wc-rank.js</li>
<li>wc-rank.less</li>
</ul>
</li>
<li>wc-rank-content<ul>
<li>wc-rank-content.html</li>
<li>wc-rank-content.js</li>
<li>wc-rank-content.less</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>将 <code>Custom Elements</code> 作为 <strong>组件名</strong> 和 __组件引用指令__，如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--wc-rank.html--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">wc-rank</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>This is a rank<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">wc-rank-content</span>&gt;</span><span class="tag">&lt;/<span class="name">wc-rank-content</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aside</span>&gt;</span>Aside of rank<span class="tag">&lt;/<span class="name">aside</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">wc-rank</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--wc-rank-content.html--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">wc-rank-content</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">content</span> <span class="attr">select</span>=<span class="string">&quot;ul&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">content</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">wc-rank-content</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--index.html--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">wc-rank</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">wc-rank-content</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span>First<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span>Second<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">wc-rank-content</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">wc-rank</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>那么最终输出可以是：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">is</span>=<span class="string">&quot;wc-rank&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>This is a rank<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">is</span>=<span class="string">&quot;wc-rank&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span>First<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span>Second<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aside</span>&gt;</span>Aside of rank<span class="tag">&lt;/<span class="name">aside</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>该过程完全可以在服务端完成，已经成为了一种简单的模板引擎。同时，如果需要执行 document.createElement(‘wc-rank’) ，可以将 wc-rank.html 和 wc-rank-content.html 带到前端进行动态解析。</p>
<p>接着，css 和 js 可以按照传统的方式进行依赖搜索和 combo。这样便将 <code>Webcomponents</code> 应用于服务端，并沿用组件化的思想和 <code>Webcomponents</code> 的草案 API，不失为前端工程化的一种解决方案。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a target="_blank" rel="noopener" href="http://webcomponents.org/">http://webcomponents.org/</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yanni4night.github.io/2016/01/03/2016-01-03-incremental-dom/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Yanni4night">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="人过不留名 雁过不留声">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 人过不留名 雁过不留声">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2016/01/03/2016-01-03-incremental-dom/" class="post-title-link" itemprop="url">Incremental DOM</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2016-01-03 16:13:27" itemprop="dateCreated datePublished" datetime="2016-01-03T16:13:27+08:00">2016-01-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-07-13 02:12:59" itemprop="dateModified" datetime="2025-07-13T02:12:59+08:00">2025-07-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/incremental-DOM-reactjs-emberjs-glimmer/" itemprop="url" rel="index"><span itemprop="name">incremental DOM reactjs emberjs glimmer</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2016/01/03/2016-01-03-incremental-dom/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/01/03/2016-01-03-incremental-dom/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p><a target="_blank" rel="noopener" href="https://github.com/google/incremental-dom">Incremental DOM</a> 是谷歌公司在 2015年4月起发起的一种支持模板引擎的高效 DOM 操作技术。相比于 <code>React.js</code> 的 <code>DOM Diff</code> 算法和 <code>Ember.js</code> 的 <code>Glimmer</code> 引擎，<code>Incremental DOM</code> 没有使用 <code>Virtual DOM</code> 的概念，转而直接去操作 DOM，因此其特点就是节约内存消耗，这对于移动端来说可能存在积极的意义。</p>
<p>先来看 <code>Incremental DOM</code> 的 API 的样子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">elementOpen</span>(<span class="string">&#x27;div&#x27;</span>, <span class="string">&#x27;&#x27;</span>, [<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;tip&#x27;</span>]);</span><br><span class="line"><span class="title function_">text</span>(<span class="string">&#x27;Hello World!&#x27;</span>);</span><br><span class="line"><span class="title function_">elementClose</span>(<span class="string">&#x27;div&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>可以说 <code>Incremental DOM</code> 的 API 十分地原始和简陋。<a target="_blank" rel="noopener" href="https://medium.com/google-developers/introducing-incremental-dom-e98f79ce2c5f">Google Developers</a> 也提到，<code>Incremental DOM</code> 并非为开发者直接使用，而是用于模板引擎的底层实现。</p>
<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>现在来简单分析下 <code>Incremental DOM</code> 的实现原理。</p>
<p>由于操作 DOM 的代价相当高，因此 <code>React.js</code> 和 <code>Glimmer</code> 都有一套算法来计算最小的 DOM 操作量。在 <code>Incremental DOM</code> 内部，通过__遍历__原始 DOM 进行脏检查来计算这个值。</p>
<p>首先了解 <code>Incremental DOM</code> 的几个概念：</p>
<h4 id="节点指针"><a href="#节点指针" class="headerlink" title="节点指针"></a>节点指针</h4><p>在 <code>Incremental DOM</code> 内部，维护了多个节点（HTMLElement）指针：</p>
<ul>
<li>currentNode：当前节点；</li>
<li>currentParent：当前节点的父节点；</li>
<li>previousNode：当前节点的前置兄弟节点；</li>
<li>prevCurrentNode：之前遍历的最后一个节点；</li>
<li>prevCurrentParent：之前遍历的最后一个节点的父节点；</li>
<li>prevPreviousNode：之前遍历的最后一个节点的前置兄弟节点</li>
</ul>
<h4 id="节点遍历"><a href="#节点遍历" class="headerlink" title="节点遍历"></a>节点遍历</h4><p>主要操作有 <code>enterNode</code>、<code>exitNode</code>、<code>nextNode</code>。</p>
<p>假设当前指针指向为：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;content&quot;</span>&gt;</span> <span class="comment">&lt;!--currentParent--&gt;</span> <span class="comment">&lt;!--prevCurrentParent--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item1&quot;</span>&gt;</span> <span class="comment">&lt;!--prevPreviousNode--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item2&quot;</span>&gt;</span> <span class="comment">&lt;!--previousNode--&gt;</span> <span class="comment">&lt;!--prevCurrentNode--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item3&quot;</span>&gt;</span> <span class="comment">&lt;!--currentNode--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">title</span>=<span class="string">&quot;tip&quot;</span>&gt;</span></span><br><span class="line">            Hello World!</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item4&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item5&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>enterNode()</code> 操作，即进入 <code>.item3</code> 内部，各指针变为：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;content&quot;</span>&gt;</span>  <span class="comment">&lt;!--prevCurrentParent--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item1&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item2&quot;</span>&gt;</span> <span class="comment">&lt;!--prevPreviousNode--&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item3&quot;</span>&gt;</span> <span class="comment">&lt;!--prevCurrentNode--&gt;</span> <span class="comment">&lt;!--currentParent--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--previousNode--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">title</span>=<span class="string">&quot;tip&quot;</span>&gt;</span> <span class="comment">&lt;!--currentNode--&gt;</span></span><br><span class="line">            Hello World!</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item4&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item5&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>exitNode()</code> 操作，离开 <code>.item3</code>，各指针变为：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;content&quot;</span>&gt;</span> <span class="comment">&lt;!--currentParent--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item1&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item2&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item3&quot;</span>&gt;</span> <span class="comment">&lt;!--prevCurrentParent--&gt;</span> <span class="comment">&lt;!--previousNode--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--prevPreviousNode--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">title</span>=<span class="string">&quot;tip&quot;</span>&gt;</span> <span class="comment">&lt;!--prevCurrentNode--&gt;</span></span><br><span class="line">            Hello World!</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item4&quot;</span>&gt;</span> <span class="comment">&lt;!--currentNode--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item5&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>nextNode()</code> 操作，遍历至下一个节点，各指针变为：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;content&quot;</span>&gt;</span> <span class="comment">&lt;!--currentParent--&gt;</span> <span class="comment">&lt;!--prevCurrentParent--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item1&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item2&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item3&quot;</span>&gt;</span> <span class="comment">&lt;!--prevPreviousNode--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">title</span>=<span class="string">&quot;tip&quot;</span>&gt;</span></span><br><span class="line">            Hello World!</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item4&quot;</span>&gt;</span> <span class="comment">&lt;!--prevCurrentNode--&gt;</span> <span class="comment">&lt;!--previousNode--&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item5&quot;</span>&gt;</span> <span class="comment">&lt;!--currentNode--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="DOM-操作"><a href="#DOM-操作" class="headerlink" title="DOM 操作"></a>DOM 操作</h2><p>明白了 <code>Incremental DOM</code> 的内部指针状态后，我们来看一个例子。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;parent&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;child&quot;</span> <span class="attr">title</span>=<span class="string">&quot;James&quot;</span>&gt;</span>Hello World!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们要修改 <code>.child</code> 元素的 title 值：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">patch</span>(<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#content&#x27;</span>), <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">elementOpen</span>(<span class="string">&#x27;div&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="literal">null</span>);</span><br><span class="line">        <span class="title function_">elementOpen</span>(<span class="string">&#x27;div&#x27;</span>, <span class="string">&#x27;&#x27;</span>, [<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;Jim&#x27;</span>]);</span><br><span class="line">            <span class="title function_">text</span>(<span class="string">&#x27;Hello World!&#x27;</span>);</span><br><span class="line">        <span class="title function_">elementClose</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">    <span class="title function_">elementClose</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>实际的 DOM 遍历和操作为：</p>
<ol>
<li>enterNode(#content)</li>
<li>enterNode(.parent)</li>
<li>enterNode(.child)</li>
<li><code>setAttribute(&#39;title&#39;, &#39;Jim&#39;)</code></li>
<li>nextNode()</li>
<li>exitNode(.child)</li>
<li>exitNode(.parent)</li>
<li>exitNode(#content)</li>
</ol>
<p>由于 JS 代码与 HTML 在结构上是一致的，因此当遍历到 <code>.child</code> 元素时，直接修改其元素，而其它元素由于结构属性都没有改变，因而没有额外的 DOM 操作。</p>
<p>如果我们要进一步修改 DOM 为：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;parent&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;child&quot;</span>&gt;</span>Hello World!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;sibling&quot;</span>&gt;</span>Hello World!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>Incremental DOM</code> 的 API 操作为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">patch</span>(<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#content&#x27;</span>), <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">elementOpen</span>(<span class="string">&#x27;div&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="literal">null</span>);</span><br><span class="line">        <span class="title function_">elementOpen</span>(<span class="string">&#x27;div&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="literal">null</span>);</span><br><span class="line">            <span class="title function_">text</span>(<span class="string">&#x27;Hello World!&#x27;</span>);</span><br><span class="line">        <span class="title function_">elementClose</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">        <span class="title function_">elementOpen</span>(<span class="string">&#x27;div&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="literal">null</span>);</span><br><span class="line">            <span class="title function_">text</span>(<span class="string">&#x27;Hello World!&#x27;</span>);</span><br><span class="line">        <span class="title function_">elementClose</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">    <span class="title function_">elementClose</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>实际的 DOM 遍历和操作为：</p>
<ol>
<li>enterNode(#content)</li>
<li>enterNode(.parent)</li>
<li>enterNode(.child)</li>
<li><code>removeAttribute(&#39;title&#39;)</code></li>
<li>nextNode()</li>
<li>exitNode(.child)</li>
<li>enterNode(.sibling)</li>
<li><code>createElement()</code></li>
<li><code>createText()</code></li>
<li>nextNode()</li>
<li>exitNode(.sibling)</li>
<li>exitNode(.parent)</li>
<li>exitNode(#content)</li>
</ol>
<p><code>Incremental DOM</code> 正是通过这种简单粗暴的方式来实现最小量的 DOM 操作。</p>
<h2 id="性能"><a href="#性能" class="headerlink" title="性能"></a>性能</h2><p>由于直接在原始 DOM 上做脏检查，<code>Incremental DOM</code> 在性能上有所下降。</p>
<p><img src="/images/incremental/LayoutAndPaint.png"></p>
<p>上图是各个框架在布局和绘画上的性能比较，可见 <code>Incremental DOM</code> 是垫底的。</p>
<p><code>Incremental DOM</code> 用性能来换取内存优化：</p>
<p><img src="/images/incremental/MajorGC.png"><br><img src="/images/incremental/MinorGC.png"></p>
<p>上图是各个框架在 GC 上的性能，<code>Incremental DOM</code> 表现十分优越。</p>
<h2 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h2><p><code>Incremental DOM</code> 的特点使得它适用于内存敏感型而非性能敏感型的应用。同时，前面也提到，<code>Incremental DOM</code> 为模板引擎的底层所设计，不适合直接调用其 API。</p>
<p>已经应用了 <code>Incremental DOM</code> 的模板引擎有：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://developers.google.com/closure/templates/">Closure Templates</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/jridgewell/babel-plugin-incremental-dom">JSX</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/davidjamesstone/superviews.js">superviews.js</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/littlstar/starplate">starplate</a></li>
</ul>
<p><code>Incremental DOM</code> 仍在发展中，相比 <code>react.js</code> 与 <code>ember.js</code> 而言并没有受到太多的关注，期待其对模板引擎在性能上的促进和发展。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yanni4night.github.io/2016/01/01/2016-01-01-npm3-dependencies/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Yanni4night">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="人过不留名 雁过不留声">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 人过不留名 雁过不留声">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2016/01/01/2016-01-01-npm3-dependencies/" class="post-title-link" itemprop="url">npm3 的依赖管理方案</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2016-01-01 18:27:03" itemprop="dateCreated datePublished" datetime="2016-01-01T18:27:03+08:00">2016-01-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-07-13 02:12:59" itemprop="dateModified" datetime="2025-07-13T02:12:59+08:00">2025-07-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/npm/" itemprop="url" rel="index"><span itemprop="name">npm</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2016/01/01/2016-01-01-npm3-dependencies/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/01/01/2016-01-01-npm3-dependencies/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>npm3 于2015年6月发布，它与 npm2 很大的一点不同是__依赖管理方案__的升级。</p>
<p>为了管理同一个模块的不同版本，npm2 采用严格树形嵌套的形式组织依赖模块的目录，而 npm3 则尽量_扁平化_，将依赖模块提升至顶层目录：</p>
<p><img src="/images/npm3/npm3deps4.png"></p>
<p>对于 B 模块的两个版本，v1 版本会被放置于顶层，而 v2 版本则因为冲突关系仍放置于 C 模块下面。</p>
<p>这样的布置有什么好处？共用。加入再有一个模块 D 依赖与 Bv1，则不必再安装，直接使用顶层的 Bv1即可。</p>
<p>那如果 A 和 D 模块都依赖 Bv2 呢？npm3 不会将 Bv2 移至顶层，而是将 Bv2 仍挂在 C 和 D 下面：</p>
<p><img src="/images/npm3/npm3deps10.png"></p>
<p>似乎 npm3 并没有那么优化到最好，Bv2 模块没有被复用。要想实现这种最优的组织，需要手动执行命令：</p>
<pre><code>$npm dedupe
</code></pre>
<p>那么，npm3 如何决定 B 模块的哪一个版本在顶层呢？答案是按照自然顺序的先后，最先安装的版本会放置于顶层。</p>
<p>理论上，自然顺序在任何情况下都是一定的，因此依赖模块的最终组织形式也是一定的。但这个前提是安装依赖之前 node_modules 是空的。一旦 node_modules 内已经有依赖模块，最终的组织形式就会受到影响。</p>
<p>假如我们现在有这样的一个应用：</p>
<p><img src="/images/npm3/npm3deps8.png"></p>
<p>修改 A 模块，使之依赖 Bv2：</p>
<p><img src="/images/npm3/npm3deps10.png"></p>
<p>现在，发布应用，在另一台机器上重新部署应用：</p>
<p><img src="/images/npm3/npm3deps17.png"></p>
<p>可见这两种环境下，依赖的目录组织形式不是一致的。</p>
<p>因此，npm3 的这种新的依赖管理方式可能造成依赖模块的目录不一致，除非所有依赖模块都删除并重新安装。但是，这种不一致理论上是无害的，每个模块都能找到所有符合要求的依赖。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://docs.npmjs.com/how-npm-works/npm3">https://docs.npmjs.com/how-npm-works/npm3</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.npmjs.com/how-npm-works/npm3-dupe">https://docs.npmjs.com/how-npm-works/npm3-dupe</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.npmjs.com/how-npm-works/npm3-nondet">https://docs.npmjs.com/how-npm-works/npm3-nondet</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yanni4night.github.io/2015/12/30/2015-12-30-dpr-scale-rem/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Yanni4night">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="人过不留名 雁过不留声">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 人过不留名 雁过不留声">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2015/12/30/2015-12-30-dpr-scale-rem/" class="post-title-link" itemprop="url">数学方法解释 dpr/scale/rem 三者的关系</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2015-12-30 16:59:04" itemprop="dateCreated datePublished" datetime="2015-12-30T16:59:04+08:00">2015-12-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-07-13 02:12:59" itemprop="dateModified" datetime="2025-07-13T02:12:59+08:00">2025-07-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/layout/" itemprop="url" rel="index"><span itemprop="name">layout</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2015/12/30/2015-12-30-dpr-scale-rem/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/12/30/2015-12-30-dpr-scale-rem/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>开发过移动端页面的同学一定听过 <code>dpr</code>、<code>scale</code>、<code>rem</code> 三个概念。最起码，也会用过 <code>scale</code>，如<br>​<br>    <meta name="viewport" content="width=device-width, initial-scale=1.0"></p>
<p>因为如果你不设置这一行，几乎所有的移动端浏览器都会把宽度设置为 <code>980px</code>，页面上的文字变得太小而难以阅读。</p>
<p>那么，这三者究竟有着怎样的关系呢？</p>
<p>首先从需求讲起。</p>
<p>移动端设备的屏幕尺寸千差万别，即便设计师能够提供每一种尺寸下的 UE 图，工程师也无法做到针对每种场景的适配。一般地，作为近似，在技术上可以使用媒体查询（media query）的方式将屏幕尺寸划分为几个等级，不同等级下使用不用的CSS样式。</p>
<p>但这显然不够精确，在不同设备上很难做到体验一致，不但代码难以维护，同时存在着被设计师吐槽的风险。</p>
<p>如何在不同的屏幕上完美还原设计图，同时兼顾有限的人力与时间？</p>
<p>由此我们可以提出需求：</p>
<ol>
<li>设计师只输出一套基准尺寸的 UE 图；</li>
<li>通过页面缩放还原 UE 图的设计比例</li>
</ol>
<p>这有两种方案：</p>
<ol>
<li>使用 rem 为单位设置各个元素的尺寸；</li>
<li>设定一个固定的页面宽度，所有元素可以使用 px 设定尺寸，然后缩放整个页面</li>
</ol>
<p>我们分开来讲讲这两种方案。</p>
<h2 id="第一种方案，rem"><a href="#第一种方案，rem" class="headerlink" title="第一种方案，rem"></a>第一种方案，rem</h2><p>我们经常看到业界的大致方案是：</p>
<blockquote>
<p>将 <code>scale</code> 设置为 <code>1 / dpr</code>，<code>&lt;html&gt;</code> 的 <code>font-size</code> 计算为 <code>screen.width * dpr / &gt;10</code>，然后在以 <code>less</code> 将UE图上得到的尺寸透明转换为对应的 <code>rem</code> 值。</p>
</blockquote>
<p>由于 <code>rem</code> 是比例值，因此能做到最终每个元素的尺寸相对于 UE 图的比例都是一致的。</p>
<p>那么，问题是，上面的公式是怎么得到的？</p>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>我们来用最基本的数据算式推导一下。</p>
<p>设基准 UE 的图宽为 <code>ue_w</code>，<code>&lt;html&gt;</code> 的 <code>font-size</code> 值为 <code>ue_fs px</code>。</p>
<p>在 PSD 上量得一个元素的宽度为 <code>psd_w px</code>，等于 <code>psd_rem</code>，即：</p>
<pre><code>psd_rem * ue_fs = psd_w -----------(1)
</code></pre>
<p>在一个宽度为 <code>foo_w</code> 的设备上，该元素应该给定的宽度为 <code>x_w px</code>。</p>
<p>根据 <code>rem</code> 单位的意义可知：</p>
<pre><code>foo_rem * foo_fs / foo_w = psd_rem * ue_fs / ue_w -----------(2)
</code></pre>
<p>即：</p>
<pre><code>foo_rem = psd_rem * (ue_fs / foo_fs) * (foo_w / ue_w) -----------(3)
</code></pre>
<p>其中 <code>psd_rem</code>、<code>ue_fs</code>、<code>foo_w</code>、<code>ue_w</code> 皆为已知，而 <code>foo_fs</code> 可给定一个具体值，相当于已知。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.px2rem</span>(<span class="keyword">@px</span>)&#123;</span><br><span class="line">    <span class="keyword">@px</span> * (foo_w) / (foo_fs * ue_w) rem</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>例如，以iPhone6的尺寸为基准，即：</p>
<pre><code>ue_fs = 75px（任取值）
ue_w = 375px
</code></pre>
<p>一个宽度为屏幕宽度一般的元素，即：</p>
<pre><code>psd_rem = 375px / 2 / 75px = 2.5rem
</code></pre>
<p>在一台 iPhone6 plus 上，则：<br>​<br>    foo_w &#x3D; 414px<br>    foo_fs &#x3D; 69px（任取值）</p>
<p>代入(3)，得<br>​<br>    foo_rem &#x3D; 2.5 * (75 &#x2F; 69) * (414 &#x2F; 375) &#x3D; 3rem &#x3D; 3 * 69px &#x3D; 414px &#x2F; 2</p>
<p>刚好也为屏幕的一半。因此，上面的 <code>LESS</code> 实际内容是：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.px2rem</span>(<span class="keyword">@px</span>)&#123;</span><br><span class="line">    <span class="keyword">@px</span> * <span class="number">0.016</span> rem</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可见，实现与 UE 图等比例的效果，只要定一个基准的 <code>ue_w</code> 和一个基准的 <code>ue_fs</code>，并任取一个当前设备的 <code>foo_fs</code> 就可以了，跟什么 <code>dpr</code>、<code>scale</code> 根本没有关系。</p>
<h3 id="事实"><a href="#事实" class="headerlink" title="事实"></a>事实</h3><p>那么如何根据屏幕宽度取一个合适的 <code>foo_fs</code> 呢？</p>
<p>再来看上面的(3)式，为了更精确的还原UE图，我们一定希望 <code>foo_rem</code> 和 <code>psd_rem</code> 都是有限小数，那么：</p>
<pre><code>(ue_fs / foo_fs) * (foo_w / ue_w)
</code></pre>
<p>就也一定是有限小数。分解：</p>
<pre><code>ue_fs / ue_w 
</code></pre>
<p>和：</p>
<pre><code>foo_fs / foo_w
</code></pre>
<p>最好都是有限小数。因此，只要取屏幕宽度的___约数___做 <code>foo_fs</code> 就可以了，如 iPhone6 上的 75px，iPhone6 plus 上的 69px 等等。</p>
<p>我们知道，在 <code>dpr</code> 大于1的设备上，是画不出来真正 1px 的，除非将 <code>scale</code> 设置成 <code>1 / dpr</code>。这样，<code>foo_w</code> 也会成倍增加：</p>
<pre><code>foo_w = screen.width * dpr
</code></pre>
<p>因此为了支持1物理像素，<code>scale</code> 必须设置成 <code>1 / dpr</code>，<code>foo_fs</code> 取 <code>screen.width * dpr</code> 的约数。</p>
<p><code>CSS3</code> 中新增了 <code>vw</code> 和 <code>vh</code> 两个单位，分别代表可见区域宽高的百分之一，目前浏览器支持程度还不好：</p>
<p><img src="/images/scale/caniuse.png" alt="caniuse"></p>
<p>为了向后兼容，我们取 <code>foo_w</code> 的十分之一（百分之一会出小数）作为 <code>foo_fs</code>：</p>
<pre><code>foo_fs = foo_w / 10 = screen.width * dpr / 10 -----------(4)
</code></pre>
<p>这样，<code>dpr</code> 为2时，一个宽度为屏幕一半的元素尺寸为 <code>5rem</code>，或 <code>50vw</code>，仅数量级不同。</p>
<p>这就是为什么业界以(4)式计算 <code>foo_fs</code> 的缘由了。</p>
<p><code>rem</code> 的方案就讲到这里，已经用数学算式推导出了 <code>foo_fs</code> 的计算公式(4)。</p>
<p>核心代码参考：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> dpr = <span class="variable language_">window</span>.<span class="property">devicePixelRatio</span>;</span><br><span class="line"><span class="keyword">var</span> meta = <span class="string">&#x27;&lt;meta name=&quot;viewport&quot; content=&quot;width=&#x27;</span> + baseW + <span class="string">&quot;, initial-scale=&quot;</span> + scale + <span class="string">&quot;, maximum-scale=&quot;</span> + scale + <span class="string">&quot;, minimum-scale=&quot;</span> + scale + <span class="string">&#x27;, user-scalable=no&quot;/&gt;&#x27;</span>;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(meta);</span><br><span class="line"><span class="keyword">var</span> style = <span class="string">&#x27;&lt;style tyle=&quot;text/css&quot;&gt;html&#123;font-size:&#x27;</span> + (screen * dpr / <span class="number">10</span>) + <span class="string">&#x27;px !important&#125;&lt;/style&gt;&#x27;</span>;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(style);</span><br></pre></td></tr></table></figure>

<h2 id="第二种方案，scale"><a href="#第二种方案，scale" class="headerlink" title="第二种方案，scale"></a>第二种方案，scale</h2><p>相比于第一种，第二种方案显得简单粗暴：</p>
<blockquote>
<p>设置一个基准的尺寸，页面上所有元素都按照此基准布局。然后将页面缩放到设备的真实尺寸上去。</p>
</blockquote>
<p>比如设定基准为 400px，而真实设备尺寸为 500px，则 <code>scale</code> 必须为 <code>500 / 400 = 1.25</code>。核心代码参考：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> baseW = <span class="number">400</span></span><br><span class="line"><span class="keyword">var</span> scale = screen.<span class="property">width</span> / baseW;</span><br><span class="line"><span class="keyword">var</span> meta = <span class="string">&#x27;&lt;meta name=&quot;viewport&quot; content=&quot;width=&#x27;</span> + baseW + <span class="string">&quot;, initial-scale=&quot;</span> + scale + <span class="string">&quot;, maximum-scale=&quot;</span> + scale + <span class="string">&quot;, minimum-scale=&quot;</span> + scale + <span class="string">&#x27;, user-scalable=no&quot;/&gt;&#x27;</span>;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(meta);</span><br></pre></td></tr></table></figure>

<p>同时还必须要设置HTML的宽度:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">400px</span> <span class="meta">!important</span>；</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>不必再去计算 <code>foo_rem</code>、<code>foo_fs</code> 等参数。由于 <code>scale</code> 并非等于 <code>1 / dpr</code>，因此1物理像素也就没法实现了。同时，<code>vw</code>、<code>vh</code> 的兼容也没有体现。好在它不需要转换 px 为 rem。</p>
<h2 id="对比"><a href="#对比" class="headerlink" title="对比"></a>对比</h2><p>比较上述两种方案：</p>
<table>
<thead>
<tr>
<th>方案</th>
<th>等比布局</th>
<th>1物理像素</th>
<th>兼容vw&#x2F;vh</th>
<th>绝对定位</th>
<th>UE尺寸</th>
<th>高清图</th>
</tr>
</thead>
<tbody><tr>
<td>第一种</td>
<td>✔</td>
<td>✔</td>
<td>✔</td>
<td>✔</td>
<td>LESS</td>
<td>✔</td>
</tr>
<tr>
<td>第二种</td>
<td>✔</td>
<td>✘</td>
<td>✘</td>
<td>✔</td>
<td>✔</td>
<td>有误差</td>
</tr>
</tbody></table>
<p>因此两种方案的使用场景是：</p>
<ol>
<li>如果必须实现1物理像素，或者需要精确的高清图片，或者对 <code>vw/vh</code> 向后兼容，则使用方案一，代表有<a target="_blank" rel="noopener" href="https://m.taobao.com/">淘宝</a>,，缺点是需要单位换算，也存在一定的误差；</li>
<li>预处理，或者需要精确的像素控制，则使用方案二开发会比较方便，代表有<a target="_blank" rel="noopener" href="http://h5.baidu.com/">百度H5</a>，缺点是不能实现1物理像素，也不能实现精确的高清图片</li>
</ol>
<h2 id="回归"><a href="#回归" class="headerlink" title="回归"></a>回归</h2><p>上述两个方案比较让人不爽的是都使用了 JavaScript 脚本来动态设置 <code>scale</code> 的大小。在苹果公司的原始设计中， <code>viewport</code> 是这样使用的么？</p>
<p>参见 <a target="_blank" rel="noopener" href="https://developer.apple.com/library/iad/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html#//apple_ref/doc/uid/TP40008193-SW6">Safari HTML Reference</a>，<code>viewport</code> 允许开发者设置 width 来调整适配的目标设备宽度，但最终<code>document.documentElement.clientWidth</code>的值为</p>
<pre><code>document.documentElement.clientWidth === Math.max(screen.width / scale, width)
</code></pre>
<p>在前面两个方案中，width 等于 <code>screen.width</code>，<code>scale</code> 小于1，因此</p>
<pre><code>document.documentElement.clientWidth === screen.width / scale === screen.width * dpr
</code></pre>
<p>如果 <code>scale</code> 写死为1，自定义的 width 不能小于 <code>screen.width</code>。但一旦 width 大于 <code>screen.width</code>，就会出现滚动条，这时，JavaScript 动态计算的 <code>scale</code> 上场了。</p>
<p>因此，按照苹果公司的设计初衷，没办法不使用 JavaScript 实现完美的 UE 还原。使用一份 UE 图，无法做到多个屏幕尺寸上呈现一致的效果。</p>
<h2 id="横屏"><a href="#横屏" class="headerlink" title="横屏"></a>横屏</h2><p>移动端开发经常缺失的一个环节是，设计师很少提供横屏版的 UE。当手机屏幕横过来怎么办？</p>
<p>可以监听 <code>resize</code>、<code>pageshow</code> 等事件，事件触发后，重新计算 <code>scale</code>、<code>foo_fs</code> 等值。这样能保证页面元素的比例仍与 UE 相当。</p>
<p>有没有问题？</p>
<p>水平方向上好像没什么问题。垂直方向呢？</p>
<p>当整体页面按比例放大后，页面高度必然也会等比放大，而在横屏模式下，屏幕垂直高度又很小，从而导致大部分内容都被推出了首屏，体验和视觉上效果都不好。</p>
<p>因此，元素的高度一般不是用 rem 而使用 px，除非元素尺寸与屏幕尺寸强相关。</p>
<p>这是不是意味着所谓的完美还原是不切实际的？对于那种划页 H5， rem 的高度仍然试用，但对于普通的文本内容则不合适了。</p>
<p>依据具体需求采取不同的方案。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>对于普通的需求，<code>width=device-width</code> 和 <code>scale=1</code> 就够了，虽然不能在不同的设备上展示同样的效果，但是够用。</p>
<p>对展现要求稍高，则使用 JavaScript 动态计算 <code>scale</code> 和 <code>foo_fs</code>。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yanni4night.github.io/2015/12/19/2015-12-19-fe-engineer/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Yanni4night">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="人过不留名 雁过不留声">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 人过不留名 雁过不留声">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2015/12/19/2015-12-19-fe-engineer/" class="post-title-link" itemprop="url">前端工程师成长之路</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2015-12-19 13:34:51" itemprop="dateCreated datePublished" datetime="2015-12-19T13:34:51+08:00">2015-12-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-07-13 02:12:59" itemprop="dateModified" datetime="2025-07-13T02:12:59+08:00">2025-07-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%B7%A5%E7%A8%8B%E5%B8%88-%E6%88%90%E9%95%BF/" itemprop="url" rel="index"><span itemprop="name">工程师 成长</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2015/12/19/2015-12-19-fe-engineer/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/12/19/2015-12-19-fe-engineer/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>当小组决定让我写这个主题时，我是拒绝的，因为以我的资历，还远远不能积累到足够的素材、故事和教训来拼凑一篇像样的回忆录。因此，这里算是我的这个主题的<code>个人</code>认识吧。</p>
<p>经常听到这样的言语：</p>
<pre><code>现在业界对前端工程师这个角色的看法是有误解的，事实上前端的工作并没有那样简单。
</code></pre>
<p>我的个人观点是：__业界没有误解，前端的工作就是那样简单__。</p>
<p>最近在特别关注UI设计的社会培训课程，几乎每家培训机构在UI课程中都会加入一项”Web前端开发”，期望能在几天的培训课程后，能够让UI设计学员掌握一定的编码技巧，有能力承担简单网页的制作、JS特效等开发。可见前端入门水平之低。</p>
<p>让我们看<a target="_blank" rel="noopener" href="http://www.lagou.com/">拉勾网</a>上一个招聘职位的 Job Description（JD）：</p>
<pre><code>1. 3年以上前端开发经验；
2. 熟练使用html和css制作符合W3C标准的页面，注重页面性能、语义化，能从整个产品的角度去考虑代码结构；
3. 熟悉JS，使用过JQ等前端框架，了解基本的语法
4. 熟悉AngularJS或同等框架,能做基于API接口的前端产品
5. 喜欢前端技术并且善于钻研，喜欢与他人分享自己的成果，乐于跟同行讨论问题
</code></pre>
<p>这是一个对有着三年工作经验的前端工程师的期望，</p>
<ul>
<li><code>熟练使用html和css制作符合W3C标准的页面</code>，这就是前端工程师的基本工作内容；”注重页面性能、语义化，能从整个产品的角度去考虑代码结构”，ok，这有一点提升的要求了，不仅仅要求你制作的页面能用，还要求一定的优化。不过这一点属于extra内容，对于一家创业团队来说，现在重点是怎么迅速将投资人的钱转换为看得见的产品，起码有个交代，至于优化这些工作，你加班来做吧，反正老板暂时是不怎么care的；</li>
<li><code>熟悉JS，使用过JQ等前端框架，了解基本的语法</code>，开什么玩笑，前端工程师如果不熟悉JS还能叫前端工程师吗，什么叫了解基本的语法，以现在这个年代的页面复杂性，恐怕需要了解全部语法而不是仅仅基本语法。不够了解全部语法也不是什么难事，相信99%的工程师都能做到，剩下那1%可以刨出工程师范畴之外了。<a target="_blank" rel="noopener" href="http://jquery.com/">JQ</a>更不必说了，即使不是前端工程师，都有一大批人听说并且有能力使用；</li>
<li><code>熟悉AngularJS或同等框架</code>，这要求又高了，<a target="_blank" rel="noopener" href="https://angularjs.org/">AngularJS</a>可不是所有前端工程师都听说过的，更不用说熟悉了，况且它那么复杂。这里有一个很有意思的点，”熟悉JS”和”熟悉AngularJS”，我理解这是一种包含的关系 ，熟悉AngularJS”必然”熟悉JS”，反之则不一定，因此，JD中的”熟悉JS”可以认为是废话；</li>
<li><code>喜欢前端技术并且善于钻研</code>，这是套话了，暂且不表</li>
</ul>
<p>看来三年的前端工作经验也无非如此，只需要掌握基本的职业技能，再花点时间稍微扩展一下知识就能拿到14k~18k的月薪了，前端就是这么一个low的职业，不需要你拥有高学历，也不需要你有能力解决XXX算法之类的烧脑问题。因此，无数非计算机专业的、计算机专业里常挂科的、野鸡大学的、培训机构的都来分前端这块面包，造就了大量的前端工程师。好在近两年互联网移动化转型，产生了大量移动web前端职位，前景似乎一片光明。</p>
<p>随着业务的发展，我们贴吧这样的前端团队也需要及时补充血液，在过去几个月里，面试了的很大一部分候选人。其实对于百度这样公司的人才甄选标准，能够进入面试环节，简历必然也是相当可以的。而且对于有工作经验的社招候选人，其编码能力也不会差到哪去，支持团队的日常业务开发任务问题不会很大。为什么大部分候选人会被毙掉呢？因为我们要的是<code>工程师</code>，而他们更像是<code>网页制作</code>。</p>
<p>这是一个很大的差异，你可以理解为战略和战术的区别：网页制作能够解决单个Case（一般是一个HTML网页）的开发就ok，而工程师则要负责一套包含HTML页面的整体解决方案。咦？前端的工作有这么复杂么？有的。什么时候有的？我不太清楚，最近几年吧。</p>
<p>我们看一些前端的工作都复杂在哪里。首先，当我们设想一个前端工程的时候，会考虑：</p>
<ul>
<li>模板与数据：应使用后端模板渲染还是前端模板，后端模板对首屏性能友好，但需考虑前后端开发解耦；前端模板需考虑框架的维护性、升级；</li>
<li>静态资源：是否需要使用各种预处理器，如何打包；</li>
<li>组件化：是否需要组件化，使用何种组件化规范，这涉及到团队多人合作问题</li>
</ul>
<p>上面每一个主题都可以拆成N多个小主题，涉及到的问题成百上千。其实前端工程中的真正难点还不是这些，而是<code>备选方案五花八门，没有统一标准</code>。相对于其它领域，前端的技术发展太快，没有一种技术能够流行到成为主流。比如前些年的JS模块化规范 <code>Require.js</code> 现在已基本不被推荐，反而基于 <code>Babel</code> 的 <code>ES6 Modules</code> 越来越流行。能够利用自己的实践经验来有效规划合适的技术架构的人，已经成为了一种新的职业：前端架构师。</p>
<p>既然前端领域也如此善变和复杂，那么一个前端工程师应该如何学习和成长才能成为一名前端架构师呢？</p>
<ol>
<li>__精通HTML&#x2F;CSS&#x2F;JS__，这是基本要求，不再冗述；</li>
<li>之前对一个对前端工程师的基本要求，也是能体现前端工程师存在价值的一点就是能够__解决各种浏览器兼容问题__。在2015~2016之交的今天，这一点似乎并不那么重要，因为越来越多的公司抛弃了IE6&amp;IE7，并且致力于移动端web开发，今天的浏览器兼容问题已经不同于从前；</li>
<li>__实现UE设计的各种交互效果__也经常出现在各个JD中，这里的”交互效果”主要指特效。曾几何时，JS的主要应用场景就是写各种交互特效，写特效也是前端工程师的必备技能之一，能够写出炫目的特效往往成为炫耀的资本。在今天，Web的风格与N年前大不相同，夸张的动效不再是为了吸引用户的眼球，反而被设计者极力避免使用，以免影响用户体验。另一方面，在移动设备上，动画已经开始使用CSS3实现而非JS实现。总之，JS特效这一环节在当前已没那么重要，在简历上标记『会使用JS实现各种效果』已经没有什么权重；</li>
<li>__精通原生JavaScript__，脱离jQuery等框架进行编程。一个框架没有绝对意义上的好不好，只有针对应用场景的适合不适合。通过编写原生JS代码，不但有机会了解W3C&#x2F;ECMAScript&#x2F;Whatwg等标准规范，还对你以后可能参与的JS框架的开发有益处；</li>
<li>__熟悉常用的JS框架__，阅读优秀的开源框架，你能看到更多的编码技巧、更优秀的设计理念，对你以后的程序设计有着绝对有益的影响。特别地，职位面试中几乎都会有关注各种框架的问题；</li>
<li>__熟悉移动端开发__，近两年移动设备的普及，特别是微信等传播平台的出现，使得前端越来越偏重向移动端，业界甚至产生了多个移动页面快速研发解决方案，如<a target="_blank" rel="noopener" href="http://www.eqxiu.com./">易企秀</a>、<a target="_blank" rel="noopener" href="http://www.maka.im/">MAKA</a>、<a target="_blank" rel="noopener" href="http://www.zhichiwangluo.com/">微页</a>、<a target="_blank" rel="noopener" href="http://www.rabbitpre.com/">兔展</a>等等，可见移动端开发的重要性；</li>
<li>__熟悉nodejs、php等非脚本语言__，未来全栈是一个很重要的方向，特别是nodejs成熟后，纯js平台的全栈对于小型团队来说尤为重要；</li>
<li>__了解前端工程化__，工程化能力才能真正一个工程师而非网页制作的价值，它需要对前端开发中的各个环节都有清晰的认知。如果没有工程化思考，复杂的前端项目将无从谈起，只会停留在网页制作的水平。</li>
</ol>
<p>以上几点是我对一名前端工程师的能力的基本认识，这与几年前相比几乎是截然不同的。之前很重要的技能在今天看来不值一提，今天必备的技能在之前看来也是遥不可及，可见随着时代变迁、技术的发展，对工程师的定义也会发生翻天覆地的变化。</p>
<p>那么成为一名合格的前端工程师之后，如何变为一名前端架构师呢？这里我认为有两点特征就够了，这两点特征也是大多数人的瓶颈，阻挡着大部分候选人进入百度，也阻碍着大部分”网页制作”变成”前端工程师”。这两点是：</p>
<ul>
<li>学习能力</li>
<li>总结能力</li>
</ul>
<p>在任何行业任何工种下，学习都是一个永恒的话题，特别对于web前端这样高速发展的领域。只有通过不断学习，才能有机会扩展视界，沉淀出足够的技术方案。同时，也只有总结，才能归纳出最合适的方案。这两点缺一不可，前端提到的几点要求只是现状，如何不满足，但拥有足够的学习和总结能力，这些就都会很快解决。因此，学习能力和总结能力才是工程师成长中最需要掌握的技能。</p>
<p>现在我们回到前面，为什么我说”前端的工作就是这么简单”，因为绝大多数业务的需求就是比较简单，只要开发一个可以看得见的网页就好了，这是普通网页制作人员就能Hold住的工作内容。这也说明了市场上绝大多数所谓”前端工程师”都是”网页制作”。一旦业务升级、团队规模扩大，”网页制作”的工作就会立即将整个团队的业务节奏推向万劫不复的深渊。一般地，在这种情况下至少会有一个人发现了问题，并开始解决，从此走向了”前端工程师”之路。</p>
<p>因此，在你的成长过程中，遇到困难和问题并非一定都是坏事，往往越糟糕的环境就越能激发你的创造天赋。在这一点上，一个有一定发展但又不足够成熟的公司往往更适合你的初期发展，它会培养你的学习和总结能力。我个人认为在中国，BAT这类公司并不合适，反而像豆瓣、知乎这类中小型公司，效率相对更高，会提供给你更大的发展空间。当你发现自己在这类公司中已经解决了很多问题，积累了足够的经验后，再去大型公司，比较一下他们的工作，会发现你之前的工作方式是多么低级和不规范，从而产生敬畏之心。当你怀着一份敬畏之心来对待这份工作，你会有着不一样的看法：前端领域深似海。</p>
<p>当我本人看穿这一切后，忽然觉得，前端如此，哪个领域又何尝不是？一味地追求极致只会让自己陷入我执当中。技术界多有高人精通，却有几人真正明白这些都是对于不完美的妥协？生活亦如此，每个人都称热爱生活，谁又会在意其背后的心酸、苦楚与无奈？</p>
<p>一切技术都是浮云，美好生活才是真谛。当你做这份工作时，失败和妥协只是你成长过程中不断被踢开的绊脚石，热爱和坚持才是那永不枯竭的推动力。不要过份追求成长，当你的经验教训积累足够，成长就会像那初春解冻的冰川，势如破竹。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yanni4night.github.io/2015/12/15/2015-12-15-liqi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Yanni4night">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="人过不留名 雁过不留声">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 人过不留名 雁过不留声">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2015/12/15/2015-12-15-liqi/" class="post-title-link" itemprop="url">利器</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2015-12-15 00:00:00" itemprop="dateCreated datePublished" datetime="2015-12-15T00:00:00+08:00">2015-12-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-07-13 02:12:59" itemprop="dateModified" datetime="2025-07-13T02:12:59+08:00">2025-07-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/liqi-%E5%88%A9%E5%99%A8/" itemprop="url" rel="index"><span itemprop="name">liqi 利器</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2015/12/15/2015-12-15-liqi/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/12/15/2015-12-15-liqi/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="/images/liqi/banner.jpg" alt="cat"></p>
<h2 id="介绍一下你自己和所做的工作。"><a href="#介绍一下你自己和所做的工作。" class="headerlink" title="介绍一下你自己和所做的工作。"></a>介绍一下你自己和所做的工作。</h2><p>我叫 yinyong，2013年硕士研究生毕业开始在宇宙中心五道口的搜狐网络大厦工作直到去年，目前在百度。2008年南方大雪的时候 <code>刚好</code> 选择了也留在西安过年，一起的还有许多不能回家的小伙伴。因为无聊，拿起了别人从图书馆借来的却没有阅读的《Java程序设计》，从此一发不可收拾踏上了编程之路。不过，毕业时做的WEB前端工程师的角色，目前扔在坚持但主要做前端技术架构方向的研究。</p>
<p>我是工程师，不是程序员。</p>
<h2 id="你都在使用哪些硬件？"><a href="#你都在使用哪些硬件？" class="headerlink" title="你都在使用哪些硬件？"></a>你都在使用哪些硬件？</h2><p>上学时喜爱手机，曾经手握7部各种操作系统的手机（iOS除外，因为买不起）。不过后来兴趣越来越淡了，在折腾了几年的Android后，年纪大了心也累了，目前手握一部iPhone6，娱乐工作都能应付，而且充电速度很满意。家里的iPad Air基本上很少碰了，之前还用它看看美剧。</p>
<p>工作上我一直使用自己购买的Mac Air 2012，后来公司发了台Mac Pro 2014，发现除了续航外，体验等方面都不如自己的Air。在公司还放着一台神舟K480N-i7D3，买来主要看上了其CPU、显卡并且价格不高，在更换了SSD并加了内存后，主要用做玩游戏。不过现在也很少玩了，电脑放在那基本算是备用机。</p>
<p>此外，我基本没有其它硬件设备，特别对机械键盘我是嗤之以鼻的，因为它会让我觉得自己是手指体力劳动者而非脑力劳动者。</p>
<h2 id="软件呢？"><a href="#软件呢？" class="headerlink" title="软件呢？"></a>软件呢？</h2><p>在文本编辑上，我一直使用 Sublime Text，最爱它的多行编辑功能，同时其插件使用Python编写也比较容易，自己也写过<a target="_blank" rel="noopener" href="https://github.com/yanni4night/sublime-custominsert">一个</a>。</p>
<p>其它软件：</p>
<ul>
<li>网易云音乐，Mac版+iOS版，开通了畅听流量包</li>
<li><a target="_blank" rel="noopener" href="http://www.bandisoft.com/bandizip/cn/">Bandizip X 2</a>，用于文件解压</li>
<li>Pages&#x2F;Keynote，日常办公文档</li>
<li><a target="_blank" rel="noopener" href="http://www.iterm2.com/">iTerm 2</a></li>
</ul>
<p>总之很少有特别的软件能反应出我的实际工作内容，甚至是便签我也一直使用mac自带的。</p>
<h2 id="你最理想的工作环境是什么？"><a href="#你最理想的工作环境是什么？" class="headerlink" title="你最理想的工作环境是什么？"></a>你最理想的工作环境是什么？</h2><p>喜欢工位的一侧靠着窗户并且有很宽广的视野，同时希望后面不要有人可以随时窥视我的显示器。</p>
<h2 id="你平时获得工作灵感的方式有哪些？"><a href="#你平时获得工作灵感的方式有哪些？" class="headerlink" title="你平时获得工作灵感的方式有哪些？"></a>你平时获得工作灵感的方式有哪些？</h2><p>因为现在很少再专注于一个具体技术问题，而更多的是大方案上的思考，因此更多的是 Google 各种国外 blog来攒取灵感。但偶尔也会去Github上搜寻有意思的项目。</p>
<h2 id="推荐一件生活中的利器给大家。"><a href="#推荐一件生活中的利器给大家。" class="headerlink" title="推荐一件生活中的利器给大家。"></a>推荐一件生活中的利器给大家。</h2><p>一款iOS应用<a target="_blank" rel="noopener" href="http://daysmatter.com/">Days Matter</a>，我用它来统计我自出生以来的天数。</p>
<hr>
<p>本文参与了「利器社群计划」，发现更多创造者和他们的工具：<a target="_blank" rel="noopener" href="http://liqi.io/community/">http://liqi.io/community/</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="上一页" aria-label="上一页" href="/page/4/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/page/6/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Yanni4night</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/yanni4night" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  






  




<script class="next-config" data-name="disqus" type="application/json">{"enable":true,"shortname":"yanni4night","count":true,"i18n":{"disqus":"disqus"}}</script>
<script src="/js/third-party/comments/disqus.js"></script>

</body>
</html>
