<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>人过不留名 雁过不留声</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="人过不留名 雁过不留声">
<meta property="og:url" content="https://yanni4night.github.io/index.html">
<meta property="og:site_name" content="人过不留名 雁过不留声">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Yanni4night">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="人过不留名 雁过不留声" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.1.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">人过不留名 雁过不留声</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://yanni4night.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-2018-09-21-prettier-eslint" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/09/21/2018-09-21-prettier-eslint/" class="article-date">
  <time class="dt-published" datetime="2018-09-21T09:24:25.000Z" itemprop="datePublished">2018-09-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/js/">js</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/09/21/2018-09-21-prettier-eslint/">prettier配合eslint执行自动化代码格式化</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://eslint.org/">eslint</a> 早已取代 <a target="_blank" rel="noopener" href="https://www.jslint.com/">jslint</a> 成为了 JavaScript 标准的风格检查工具，提供了大量规则（rule）。这些规则部分是可以支持 <em>fixable</em> 的，也就是说可以自动修复代码。但是现在来看，eslint 提供的修复功能还是太弱。因此 Facebook 开发了 <a target="_blank" rel="noopener" href="https://prettier.io/">prettier</a>，一个专门司职代码格式化的工具，它不仅仅支持 JavaScript 语法，甚至还支持 Markdown。因此，把它们配合起来是一种自然而然的想法，首先我们有一个 eslint-config 定义，我们希望经过 format 之后的代码能100%通过 lint 校验。我们也希望在 git hook 中能自动 format 代码。</p>
<p>在实际应用中，让 prettier 完美配合 eslint 并不容易。根本原因在于 prettier 格式化代码的一些行为是不可配置的，而这些配置极有可能与 eslint 配置是冲突的。</p>
<p>例如下面的代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a === <span class="number">1</span> || b === <span class="number">2</span> || c ===<span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>在 eslint 中，我们经常配置在折行时把符号写在前边：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a === <span class="number">1</span></span><br><span class="line">|| b === <span class="number">2</span></span><br><span class="line">|| c ===<span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>但 prettier 则强行写在后面：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a === <span class="number">1</span> ||</span><br><span class="line">b === <span class="number">2</span> ||</span><br><span class="line">c ===<span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>prettier 提供了与 eslint 配合使用的<a target="_blank" rel="noopener" href="https://prettier.io/docs/en/eslint.html">官方方法</a>。但这种方式的本质是使用 eslint-config-prettier 来抹平 prettier 与 eslint 之间不可调和的冲突。一旦我们定义的私有 eslint-config 与 eslint-config-prettier 有影响格式化结果的冲突，那么 lint 必然失败。不过这种方式的一大好处是仅仅对接 eslint 就能完成 lint 与 fix 的操作，集成性很强。</p>
<p>理解这种现象很容易，eslint 的 rules 是没有顺序的，因此在 fix 阶段，极有可能 prettier 的 rule 执行在最后阶段，结果显然与我们定义的最终 eslint 配置是冲突的。</p>
<hr>
<p>相比于引用一系列 eslint-config，并维护它们的顺序，我们索性只维护我们自己的一份 eslint-config，反而更清晰。有这一份配置来执行 fix，产出一定可以通过lint。</p>
<p>但我们肯定不想直接抛弃 prettier，那么就把它的执行放在最前面，让它的产出再通过 eslint 即可。</p>
<p>已经存在这种现成的解决方案，就是 <a target="_blank" rel="noopener" href="https://github.com/prettier/prettier-eslint">prettier-eslint</a>。虽然看起来比较畸形，但可能是唯一一种比较能用且清晰的方案了。</p>
<p>但也有缺点，一旦将来某些 prettier 的不可配置的行为也不能被 eslint 所 fix，工作流就 gg 了。整合的过程就是这样，本来是相互分离的两个系统，让它们一起工作，总要失去点什么。</p>
<blockquote>
<p>Code ➡️ prettier ➡️ eslint –fix ➡️ Formatted Code ✨</p>
</blockquote>
<p>Q：如果能保证 prettier 提供的 rule 能先行执行呢？</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://yanni4night.github.io/2018/09/21/2018-09-21-prettier-eslint/" data-id="cl1ul7d72003ajc2vdr7n3xo0" data-title="prettier配合eslint执行自动化代码格式化" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2018-03-23-principle-+" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/03/23/2018-03-23-principle-+/" class="article-date">
  <time class="dt-published" datetime="2018-03-23T07:02:57.000Z" itemprop="datePublished">2018-03-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/js/">js</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/03/23/2018-03-23-principle-+/">Javascript &#39;+&#39; 运算符原理</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>继了解完“&#x3D;&#x3D;”的原理后，再来了解一下加号“+”的 ECMAScript 实现原理。</p>
<p>例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a + b</span><br></pre></td></tr></table></figure>

<p>第一步，对 a 和 b 执行 *toPrimitive()*，不指定 <a target="_blank" rel="noopener" href="https://tc39.github.io/ecma262/#sec-ordinarytoprimitive">hint</a>。</p>
<p>以 <em>toPrimitive(a)</em> 为例，先看 a 有没有定义 <em>Symbol.toPrimitive</em>，比如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">a[<span class="title class_">Symbol</span>.<span class="property">toPrimitive</span>] = customToPrimitive;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">customToPrimitive</span>(<span class="params">hint</span>) &#123;</span><br><span class="line">    <span class="keyword">switch</span> (hint) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;number&#x27;</span>:</span><br><span class="line">            ...</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;string&#x27;</span>:</span><br><span class="line">            ...</span><br><span class="line">        <span class="attr">default</span>: <span class="comment">// &#x27;default&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>如果定义了 <em>Symbol.toPrimitive</em> 属性，则执行：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">customToPrimitive.<span class="title function_">call</span>(a, <span class="string">&#x27;default&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>否则执行原生 *toPrimitive(“number”)*，也就是要依次调用 a 的 <em>valueOf</em> 和 <em>toString</em> 方法。</p>
<p>如果执行 <em>a.valueOf()</em> 返回不是 Object，则为 <em>toPrimitive(a)</em> 的终值，否则执行 *a.toString()*。</p>
<p>接下来，看 a 有没有定义 toString，如果有，则执行 *a.toString()*，为 <em>toPrimitive(a)</em> 的终值。</p>
<p>如果没有，则执行原型链顶端的 <em>Object.prototype.toString</em>,这首先要看 a 有没有定义 <em>Symbol.toStringTag</em>。</p>
<p>如果定义了，比如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">customStringTag</span>(<span class="params"></span>) &#123;</span><br><span class="line">        ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(a, <span class="title class_">Symbol</span>.<span class="property">toStringTag</span>, &#123;</span><br><span class="line">    <span class="attr">get</span>: customStringTag</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>那么返回 *”[object “ + customStringTag.apply(a) + “]”*，否则返回 *”[object Object]”*，为 <em>toPrimitive(a)</em> 的终值。</p>
<p>如果发现 <em>toPrimitive(a)</em> 或者 <em>toPrimitive(b)</em> 任一为字符串，则执行字符串拼接，否则执行数字加法，即 *toNumber(a) + toNumber(b)*，这也能解释 <strong>true + true &#x3D; 2</strong> 的问题。</p>
<hr>
<p>可见 <em>a + b</em> 核心就是 <em>toPrimitive</em> 操作，只不过从 ES2015 以来，<em>toPrimitive</em> 受到 Symbol 的影响，变得越来越复杂。</p>
<p>相比之下，减号“-”就很简单了，就是执行 *toNumber(a) - toNumber(b)*。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://yanni4night.github.io/2018/03/23/2018-03-23-principle-+/" data-id="cl1ul7d710038jc2vajqea0y5" data-title="Javascript &#39;+&#39; 运算符原理" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2018-02-27-cultivating-a-paradoxical-frame-of-mind" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/02/27/2018-02-27-cultivating-a-paradoxical-frame-of-mind/" class="article-date">
  <time class="dt-published" datetime="2018-02-27T08:43:11.000Z" itemprop="datePublished">2018-02-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/reading/">reading</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/02/27/2018-02-27-cultivating-a-paradoxical-frame-of-mind/">《咨询的奥秘》 第二章 培养矛盾的思维框架</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>对于社会主义的中国人来讲，经过初中、高中、大学的思想政治课的洗礼，理解矛盾并非难事，我们辩证唯物主义的内容要更丰富得多。</p>
<h1 id="第二章-培养矛盾的思维框架"><a href="#第二章-培养矛盾的思维框架" class="headerlink" title="第二章 培养矛盾的思维框架"></a>第二章 培养矛盾的思维框架</h1><h2 id="不要理性，要合理"><a href="#不要理性，要合理" class="headerlink" title="不要理性，要合理"></a>不要理性，要合理</h2><p>这两个相似的词忽然让我很难揣摩这句只包含6个字的话。什么样的事情是合理但不理性的呢？我理解，理性是对事件真实客观的描述，是能用逻辑严格证明的，往往获取“理性”需要很大的成本，甚至在有意义的时间内无法获取；而合理则是一种模棱两可的适当妥协，在有些事情无法获取“理性”之时，委曲求全的权宜之计都可能是一种合理。合理是一种“反牛角尖的”行为，似乎更倾向于“糊弄”。</p>
<p>在作者涉猎的软件咨询行业，很难想象不求甚解的方案也能行得通。从技术上来讲，确实再隐晦的故障都是可以绝对定位的，但对于项目来说，往往最初的设计和真正的落地会有很大差距，如果没有绝对的经验积累，那么项目在循循渐进的过程中往往都会带着猜的成份。换句话说，没有理性，只要比上一版本又说改进，即为合理。从这角度上来说，一味得追求最佳既是不可能的任务，也不能称之为理性的抉择，毕竟世界是个矛盾体，在矛盾中寻求理性的过程收获利益，才是上上之选。</p>
<p>从这里可以衍生出一种经典的产品进化模型，比如想造一辆汽车，下面有两种方案：</p>
<ol>
<li>第一种，先造轮子、发动机、车架，最终拼接成完善的汽车；</li>
<li>第二种，先造一辆自行车、摩托车、三轮车，最后一辆汽车</li>
</ol>
<p>第二种方案看似费时费力，往往更容易被人接受，也更容易实现。</p>
<h2 id="自以为无所不知的人最容易上当"><a href="#自以为无所不知的人最容易上当" class="headerlink" title="自以为无所不知的人最容易上当"></a>自以为无所不知的人最容易上当</h2><p>过于自信就是自负，往往容易对客观事实视而不见。这和“撞车的都是老司机”、“淹死的都是会水的”是类似的道理。</p>
<h2 id="生活太重要，所以不能太较真"><a href="#生活太重要，所以不能太较真" class="headerlink" title="生活太重要，所以不能太较真"></a>生活太重要，所以不能太较真</h2><p>这论题太大了，似乎已经上升到了哲学和三观的高度上来了。我想作者要表达的意思应该是，对于无法解释的事物不必过于在意，毕竟你的无知正是矛盾世界里的必不可少的成份。</p>
<h2 id="不付出就什么也得不到"><a href="#不付出就什么也得不到" class="headerlink" title="不付出就什么也得不到"></a>不付出就什么也得不到</h2><p>正是矛盾的合理体现，要想得到什么，不可避免地要失去什么，当然，反过来不一定成立，往往都不成立。</p>
<h2 id="提升一方面，就要牺牲另一方面"><a href="#提升一方面，就要牺牲另一方面" class="headerlink" title="提升一方面，就要牺牲另一方面"></a>提升一方面，就要牺牲另一方面</h2><p>同上</p>
<h2 id="费舍基本定理——你越适应现状，就越难适应变化"><a href="#费舍基本定理——你越适应现状，就越难适应变化" class="headerlink" title="费舍基本定理——你越适应现状，就越难适应变化"></a>费舍基本定理——你越适应现状，就越难适应变化</h2><p>显然，与现有系统耦合越大，与其它系统兼容越小。抽象与具象。</p>
<blockquote>
<p>伴随着年纪的增长，我觉得自己就越来越难以适应变化。</p>
</blockquote>
<h2 id="顾问一般在解决你提出的第三个问题时最有成效"><a href="#顾问一般在解决你提出的第三个问题时最有成效" class="headerlink" title="顾问一般在解决你提出的第三个问题时最有成效"></a>顾问一般在解决你提出的第三个问题时最有成效</h2><p>这也解释了为什么人在20多岁的时候最富创造性，因为年老后才更“善于”和这个“平庸”的世界打交道。</p>
<p>始终关注自己在什么时候拥有最高效的进步，在合适的时候，应当勇于舍弃舒适的温床。</p>
<blockquote>
<p>我确实应该换个工作了🍟</p>
</blockquote>
<h2 id="我们能做，这是所需的费用"><a href="#我们能做，这是所需的费用" class="headerlink" title="我们能做，这是所需的费用"></a>我们能做，这是所需的费用</h2><p>没有成本的改变是不现实的，懂得这个道理，避免在愚蠢的任务上浪费时间与口舌。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://yanni4night.github.io/2018/02/27/2018-02-27-cultivating-a-paradoxical-frame-of-mind/" data-id="cl1ul7d6z0035jc2vd45t8opq" data-title="《咨询的奥秘》 第二章 培养矛盾的思维框架" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2018-02-19-pagex" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/02/19/2018-02-19-pagex/" class="article-date">
  <time class="dt-published" datetime="2018-02-19T10:00:15.000Z" itemprop="datePublished">2018-02-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/js/">js</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/02/19/2018-02-19-pagex/">获取元素在文档流中的位置</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>元素在文档流中的位置应与页面滚动量无关，指的是该元素左上角（包括border，但不包括margin）距离整个页面左上角的水平和垂直位置。</p>
<p>获取此位置有两种方法，观察 <a target="_blank" rel="noopener" href="https://github.com/jquery/jquery/blob/2.2-stable/src/offset.js#L101">jQuery 2.2 源码</a>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> rect = elem.<span class="title function_">getBoundingClientRect</span>();</span><br><span class="line"><span class="keyword">var</span> win = elem.<span class="property">ownerDocument</span>.<span class="property">defaultView</span>;</span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">top</span>: rect.<span class="property">top</span> + win.<span class="property">pageYOffset</span>,</span><br><span class="line">    <span class="attr">left</span>: rect.<span class="property">left</span> + win.<span class="property">pageXOffset</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><code>getBoundingClientRect</code> 是一个十分高效的方法，用来获取元素相对于可见的视口的位置，而这个位置是与滚动量有关的，只有这个位置加上滚动量，即是与文档左上角的距离。</p>
<p>如果 <code>getBoundingClientRect</code> 不存在，我们依然可以通过遍历计算出结果。首先需要了解 DOM 元素的几个属性：</p>
<ol>
<li>offsetParent 向上祖先中第一个定位元素；</li>
<li>offsetLeft 距离 offsetParent 左边界的水平位置，与滚动量无关</li>
<li>offsetTop 距离 offsetParent 上边界的垂直位置，与滚动量无关</li>
<li>clientLeft 一般为左边框宽度</li>
<li>clientTop 一般为上边框宽度</li>
<li>scrollLeft 水平滚动距离</li>
<li>scrollTop 垂直滚动距离</li>
</ol>
<p>因为我们要得到的距离是当时的绝对距离，与该元素的各个祖先元素的滚动量是有关的，因此我们不能简单地通过加和 <em>offsetLeft</em> 与 <em>offsetTop</em> 来得到最后的值，必须减去每一级祖先的滚动量。</p>
<p>具体逻辑大概就是，向该元素的上面遍历，减去每个元素的滚动量，一旦遇到是 <em>offsetParent</em>，则加上 <em>offsetLeft</em> 与 <em>offsetTop</em>。具体可参考 <a target="_blank" rel="noopener" href="https://github.com/jquery/jquery/blob/1.4.4/src/offset.js#L79">jQuery 1.4.4 源码</a>。简单来讲就是：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">offset</span>(<span class="params">ele</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> top = ele.<span class="property">offsetTop</span>;</span><br><span class="line">    <span class="keyword">var</span> left = ele.<span class="property">offsetLeft</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> offsetParent = ele.<span class="property">offsetParent</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>((ele = ele.<span class="property">parentNode</span>) &amp;&amp; ele !== <span class="variable language_">document</span>) &#123;</span><br><span class="line">        left -= (ele.<span class="property">scrollLeft</span>);</span><br><span class="line">        top -= (ele.<span class="property">scrollTop</span>);</span><br><span class="line">        <span class="keyword">if</span> (offsetParent === ele) &#123;</span><br><span class="line">            top += ele.<span class="property">offsetTop</span> + ele.<span class="property">clientTop</span>;</span><br><span class="line">            left += ele.<span class="property">offsetLeft</span> + ele.<span class="property">clientLeft</span>;</span><br><span class="line">            offsetParent = offsetParent.<span class="property">offsetParent</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;top,left&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>当然 clientTop 与 clientLeft 并非永远代表的是上边框和左边框的宽度。</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://yanni4night.github.io/2018/02/19/2018-02-19-pagex/" data-id="cl1ul7d6y0033jc2vdr2xflz2" data-title="获取元素在文档流中的位置" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2018-02-12-vue-dom-diff" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/02/12/2018-02-12-vue-dom-diff/" class="article-date">
  <time class="dt-published" datetime="2018-02-12T06:41:01.000Z" itemprop="datePublished">2018-02-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/js/">js</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/02/12/2018-02-12-vue-dom-diff/">Vue.js 中的 DOM Diff 算法</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>上一篇我们熟悉了一下 <em>Inferno.js</em> 的 DOM Diff 算法。今天我们来看 <a target="_blank" rel="noopener" href="https://vuejs.org/">Vue.js</a> 框架的 DOM Diff 算法。</p>
<p><em>Vue.js</em> 的作者没有编写自己的算法，而是使用了 <a target="_blank" rel="noopener" href="https://github.com/snabbdom/snabbdom">Snabbdom</a>，并做了适当的修改。</p>
<p>DOM Diff 的关键算法在 <a target="_blank" rel="noopener" href="https://github.com/snabbdom/snabbdom/blob/v0.7.1/src/snabbdom.ts#L179">https://github.com/snabbdom/snabbdom/blob/v0.7.1/src/snabbdom.ts#L179</a>。</p>
<p>同样，我们依然假设有原始的 DOM 集合A为 “<em>dfibge</em>”，更新后的集合B为 “<em>igfheb</em>”。</p>
<p>创建4个指针 <em>oldStartIdx</em>、<em>oldEndIdx</em>、<em>newStartIdx</em>、<em>newEndIdx</em>，初始分别指向A的起始点、结束点和B的起始点、结束点。显然：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">oldStartIdx=<span class="number">0</span></span><br><span class="line">oldEndIdx=<span class="number">5</span></span><br><span class="line">newStartIdx=<span class="number">0</span></span><br><span class="line">newEndIdx=<span class="number">5</span></span><br></pre></td></tr></table></figure>

<p>第一步，比较 A[oldStartIdx] 和 B[newStartIdx]，如果相同，则 oldStartIdx++、newStartIdx++。<br>第二步，比较 A[oldEndIdx] 和 B[newEndIdx]，如果相同，则 oldEndIdx++、newEndIdx++。</p>
<p>在本例中，以上两步全部不满足，跳过。</p>
<p>第三步，比较 A[oldStartVnode] 和 B[newEndVnode]，如果相同，则节点发生了右移。<br>第四步，比较 A[oldEndIdx] 和 B[newStartIdx]，如果相同，则节点发生了左移。</p>
<p>在本例中，以上两步全部不满足，跳过。</p>
<p>第五步，在A中搜索 B[newStartIdx]，即 <em>i</em>，找到则把A中的 <em>i</em> 移到 A[oldStartVnode] 前面并 newStartIdx++、oldStartVnode++，否则则创建它。</p>
<p>在本例中，A变成 <em>idfbge</em>。</p>
<p>返回第一步。</p>
<hr>
<p>可以看到这个算法类似于优化后的插入排序。按照此算法，A的变换路径为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">A:dfibge</span><br><span class="line">B:igfheb</span><br><span class="line"></span><br><span class="line">=&gt;</span><br><span class="line"></span><br><span class="line">A:idfbge</span><br><span class="line">B:igfheb</span><br><span class="line">  ^</span><br><span class="line"></span><br><span class="line">=&gt;</span><br><span class="line"></span><br><span class="line">A:igdfbe</span><br><span class="line">B:igfheb</span><br><span class="line">   ^</span><br><span class="line"></span><br><span class="line">=&gt;</span><br><span class="line"></span><br><span class="line">A:igfdbe</span><br><span class="line">B:igfheb</span><br><span class="line">    ^</span><br><span class="line"></span><br><span class="line">=&gt;</span><br><span class="line"></span><br><span class="line">A:igfhdbe</span><br><span class="line">B:igfheb</span><br><span class="line">     ^</span><br><span class="line"></span><br><span class="line">=&gt;</span><br><span class="line"></span><br><span class="line">A:igfhedb</span><br><span class="line">B:igfheb</span><br><span class="line">      ^</span><br><span class="line"></span><br><span class="line">=&gt;</span><br><span class="line"></span><br><span class="line">A:igfhebd</span><br><span class="line">B:igfheb</span><br><span class="line">       ^</span><br><span class="line">=&gt;</span><br><span class="line"></span><br><span class="line">A:igfheb</span><br><span class="line">B:igfheb</span><br><span class="line">       ^</span><br></pre></td></tr></table></figure>

<p>用一句话概括此算法的核心就是：依次遍历B集合，在A集合中找到对应项，放到与在B集合中相同的位置上。只不过 <em>Snabbdom</em> 使用了双向同时遍历来进行优化。</p>
<p>事实上，React 的 DOM Diff 算法与此也是非常类似的，只不过受限于 Fiber，只进行了单向搜索。但是即便如此， React 也引入了优化策略，尽量使得更多的元素不必移动。从本质上来看，Inferno 和 React 都利用递增子序列来进行了优化，但是 Inferno 使用算法来保证是最大递增子序列，而 React 的子序列是一定从第一个元素开始的，因此不一定是最大子序列。这在尾部元素移动到首部的时候，差异表现得更明显。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://yanni4night.github.io/2018/02/12/2018-02-12-vue-dom-diff/" data-id="cl1ul7d6x0030jc2v2a9tac6l" data-title="Vue.js 中的 DOM Diff 算法" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2018-02-11-inferno-dom-diff" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/02/11/2018-02-11-inferno-dom-diff/" class="article-date">
  <time class="dt-published" datetime="2018-02-11T10:20:59.000Z" itemprop="datePublished">2018-02-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/js/">js</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/02/11/2018-02-11-inferno-dom-diff/">Inferno.js 中的 DOM Diff 算法</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>已经关注 <a target="_blank" rel="noopener" href="https://infernojs.org/">Inferno.js</a> 有两年的时间，终于在刚刚不久的过去建立起了官网和文档。</p>
<p>值得特别关注的是，<em>Inferno.js</em> 提供了类 React API 的同时，在 DOM Diff 算法上借鉴了 <a target="_blank" rel="noopener" href="https://github.com/ivijs/ivi">ivijs</a>，取得了更高的效率，从而有较强的性能表现。</p>
<p>优秀的 DOM Diff 算法的核心都是在将一个 DOM 集合转换成另一个 DOM 集合的同时，尽可能地复用已有 DOM 并具有较少的 DOM 移动操作，这是由于 DOM 操作（甚至访问）的成本较高。</p>
<p><em>Inferno.js</em> 在两个 VDom 之间进行比较，从而避免了频繁访问 DOM 的性能开销。下面我们看一下它实现的 DOM Diff 算法。</p>
<p>我们假设有原始的 DOM 集合A为 “<em>dfibge</em>”，更新后的集合B为 “<em>igfheb</em>”。</p>
<p>首先得到集合B中元素在A中的原始位置，如果在A中不存在则为-1，得到：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> A       = [d, f, i,  b, g, e];</span><br><span class="line"><span class="keyword">var</span> B       = [i, g, f,  h, e, b];</span><br><span class="line"><span class="keyword">var</span> sources = [<span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, -<span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>];</span><br></pre></td></tr></table></figure>

<p>现在我们获取该数组的最大递增子序列的序列位置，为：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> seq = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">4</span>];<span class="comment">// [2, 4, 5]</span></span><br></pre></td></tr></table></figure>

<p>这个数组的意义在于：“新数组中第0、1、4位置的元素在原始数组中是无需移动的”，这是我们能获取最小移动步数的关键。</p>
<blockquote>
<p>一共6个成员，3个无需移动，那么一定有3个需要操作</p>
</blockquote>
<p>现在我们从后往前遍历集合B，观察每个成员的位置是否存在于 <em>seq</em> 中，存在则不必操作，不存在则需移动。</p>
<p>首先我们需要先删除B中存在，但A中不存在的元素 <em>d</em>，此时：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A=[f, i, b, g, e]</span><br></pre></td></tr></table></figure>

<p>观察B中最后一个元素：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A=[f, i, b, g, e]</span><br><span class="line">B=[i, g, f, h, e, b]</span><br><span class="line">                  ^ pos=5</span><br></pre></td></tr></table></figure>

<p>位置是5，不存在于 <em>seq</em> 中，需要把集合A中的 <em>b</em> 移到最后，此时：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A=[f, i, g, e, b] --- (1)</span><br></pre></td></tr></table></figure>

<p>观察B中倒数第二个元素：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A=[f, i, b, g, e]</span><br><span class="line">B=[i, g, f, h, e, b]</span><br><span class="line">               ^ pos=4</span><br></pre></td></tr></table></figure>

<p>位置是4，存在于 <em>seq</em> 中，无需操作。</p>
<p>观察B中倒数第三个元素：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A=[f, i, b, g, e]</span><br><span class="line">B=[i, g, f, h, e, b]</span><br><span class="line">            ^ pos=3</span><br></pre></td></tr></table></figure>

<p>在A中不存在，我们需要创建 <em>h</em>，并放到 <em>e</em> 的前面，此时：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A=[f, i, g, h, e, b] --- (2)</span><br></pre></td></tr></table></figure>

<p>观察B中倒数第四个元素：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A=[f, i, g, h, e, b]</span><br><span class="line">B=[i, g, f, h, e, b]</span><br><span class="line">         ^ pos=2</span><br></pre></td></tr></table></figure>

<p>位置是2，不存在于 <em>seq</em> 中，需要把集合A中的 <em>f</em> 移到 <em>h</em> 的前面，此时：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A=[i, g, f, h, e, b] --- (3)</span><br></pre></td></tr></table></figure>

<p>观察B中倒数第五个元素：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A=[i, g, f, h, e, b]</span><br><span class="line">B=[i, g, f, h, e, b]</span><br><span class="line">      ^ pos=1</span><br></pre></td></tr></table></figure>

<p>位置是1，存在于 <em>seq</em> 中，无需任何操作。</p>
<p>观察B中倒数第六个元素，也是最后一个元素：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A=[f, i, b, g, e]</span><br><span class="line">B=[i, g, f, h, e, b]</span><br><span class="line">   ^ pos=0</span><br></pre></td></tr></table></figure>

<p>位置是0，存在于<em>seq</em>中，也无需任何操作。</p>
<p>此时，所有操作都已结束，仅需3步，集合A已经转换成了集合B。其中，对 <em>d</em> 的移除和对 <em>h</em> 的创建是不可避免的，除此之外，仅进行了两次DOM移动，也印证了上面提到的 6-3&#x3D;3 的操作步骤。</p>
<blockquote>
<p>我们在移动 DOM 的时候都是执行的“插在XXX之前”，是因为 DOM 中的 <em>insertBefore</em> 方法，如果存在 insertAfter，那么从前往后操作也是等效的。</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://yanni4night.github.io/2018/02/11/2018-02-11-inferno-dom-diff/" data-id="cl1ul7d6w002yjc2v6y1qa9x1" data-title="Inferno.js 中的 DOM Diff 算法" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2018-02-07-js-inherits" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/02/06/2018-02-07-js-inherits/" class="article-date">
  <time class="dt-published" datetime="2018-02-06T13:37:24.000Z" itemprop="datePublished">2018-02-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/js/">js</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/02/06/2018-02-07-js-inherits/">JavaScript 中继承的实现</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>我们都知道 JavaScript 是通过原型链继承的，在不支持 class、extends 语法的环境里，继承又该如何实现呢？</p>
<p>首先我们来整理实现继承后的效果表征，假设存在两个类（函数）A 和 B，我们要实现 B 继承于 A，那么需要满足：</p>
<ol>
<li>new B() instanceof A 为真；</li>
<li>B.prototype.constructor &#x3D;&#x3D;&#x3D; B 为真；</li>
<li>如果 A.foo &#x3D; 1，则 B.foo &#x3D; 1 为真，即静态变量可继承；</li>
<li>在普通方法 foo 中可以调用 super.foo() 调用基类方法；</li>
<li>在构造方法中可以调用 super() 调用基类构造方法</li>
</ol>
<p>在很多年前，jQuery 作者 <em>John Resig</em> 曾写过一个继承的<a target="_blank" rel="noopener" href="https://johnresig.com/blog/simple-javascript-inheritance/">实现</a>，在那个还在 ES3 语法的时代已经非常难得。在今天看来，这种实现方式的语义已经远远落后，同时也不能实现静态变量。</p>
<hr>
<p>下面我们来一步一步地去理解 babel 的实现方式。</p>
<p>首先定义两个类（函数），以及子类的实例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">A</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">B</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = <span class="keyword">new</span> <span class="title function_">B</span>();</span><br></pre></td></tr></table></figure>

<p>想实现 B 继承于 A，那边必然 <em>b instanceof B</em> 为真，根据 instanceof 的意义，一定有：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b.<span class="property">__proto__</span>.<span class="property">__proto__</span>... === A.<span class="property"><span class="keyword">prototype</span></span></span><br></pre></td></tr></table></figure>

<p>我们知道：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b.<span class="property">__proto__</span> === B.<span class="property"><span class="keyword">prototype</span></span></span><br></pre></td></tr></table></figure>

<p>那么我们只需要：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span>... === A.<span class="property"><span class="keyword">prototype</span></span></span><br></pre></td></tr></table></figure>

<p>于是我们覆写 <em>B.prototype</em>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(A.<span class="property"><span class="keyword">prototype</span></span>)</span><br></pre></td></tr></table></figure>

<p>这样一定有 <em>A.prototype.isPrototypeOf(B.prototype)</em> 为真。</p>
<p>现在我们已经实现了：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b <span class="keyword">instanceof</span> A === <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>也就是说第一条我们已经实现了，下面看第二条，只需要：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> = B;</span><br></pre></td></tr></table></figure>

<p>或者更优雅一些：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">B.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(A.<span class="property"><span class="keyword">prototype</span></span>, &#123;</span><br><span class="line">    <span class="attr">constructor</span>: &#123;</span><br><span class="line">        <span class="attr">value</span>: B,</span><br><span class="line">        <span class="attr">enumerable</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">writable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">configurable</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>现在我们要实现静态成员的继承：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Object</span>.<span class="title function_">setPrototypeOf</span>(B, A);</span><br></pre></td></tr></table></figure>

<p>目前为止，我们定义的是两个空类，现在我们为他们增加 name 属性：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">A</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">B</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">A.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>, &#123;</span><br><span class="line">    <span class="attr">constructor</span>: &#123;</span><br><span class="line">        <span class="attr">value</span>: A,</span><br><span class="line">        <span class="attr">enumerable</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">writable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">configurable</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">name</span>: &#123;</span><br><span class="line">        <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">configurable</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">B.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(A.<span class="property"><span class="keyword">prototype</span></span>, &#123;</span><br><span class="line">    <span class="attr">constructor</span>: &#123;</span><br><span class="line">        <span class="attr">value</span>: B,</span><br><span class="line">        <span class="attr">enumerable</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">writable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">configurable</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">name</span>: &#123;</span><br><span class="line">        <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">configurable</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">setPrototypeOf</span>(B, A);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">new</span> <span class="title function_">A</span>().<span class="property">name</span>); <span class="comment">// =&gt; A</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">new</span> <span class="title function_">B</span>().<span class="property">name</span>); <span class="comment">// =&gt; B</span></span><br></pre></td></tr></table></figure>

<p>现在我们要在 B 的 name 中获取父类的 name 属性，那么我们就需要找到 B.prototype 中的 name。</p>
<p>在 B 环境中，灵活的做法是通过 B.prototype 找到 A.prototype，根据 *B.prototype &#x3D; Object.create(A.prototype)*，我们知道：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A.<span class="property"><span class="keyword">prototype</span></span> === <span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(B.<span class="property"><span class="keyword">prototype</span></span>)</span><br></pre></td></tr></table></figure>

<p>于是：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">A</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">B</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">A.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>, &#123;</span><br><span class="line">    <span class="attr">constructor</span>: &#123;</span><br><span class="line">        <span class="attr">value</span>: A,</span><br><span class="line">        <span class="attr">enumerable</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">writable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">configurable</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">name</span>: &#123;</span><br><span class="line">        <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">configurable</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">B.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(A.<span class="property"><span class="keyword">prototype</span></span>, &#123;</span><br><span class="line">    <span class="attr">constructor</span>: &#123;</span><br><span class="line">        <span class="attr">value</span>: B,</span><br><span class="line">        <span class="attr">enumerable</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">writable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">configurable</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">name</span>: &#123;</span><br><span class="line">        <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> sup = <span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(B.<span class="property"><span class="keyword">prototype</span></span>);</span><br><span class="line">            <span class="keyword">var</span> desc = <span class="title class_">Object</span>.<span class="title function_">getOwnPropertyDescriptor</span>(sup, <span class="string">&#x27;name&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span> desc.<span class="property">get</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>) + <span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">configurable</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">setPrototypeOf</span>(B, A);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">new</span> <span class="title function_">A</span>().<span class="property">name</span>); <span class="comment">// =&gt; A</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">new</span> <span class="title function_">B</span>().<span class="property">name</span>); <span class="comment">// =&gt; AB</span></span><br></pre></td></tr></table></figure>

<p>这就实现了 super.name 的效果。当然，我们假设 B 的父类是定义了 name 的，如果没有找到 name，那应该沿着原型链继续向上寻找。因此更健壮的写法是：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">A</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">B</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">A.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>, &#123;</span><br><span class="line">    <span class="attr">constructor</span>: &#123;</span><br><span class="line">        <span class="attr">value</span>: A,</span><br><span class="line">        <span class="attr">enumerable</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">writable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">configurable</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">name</span>: &#123;</span><br><span class="line">        <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">configurable</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">B.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(A.<span class="property"><span class="keyword">prototype</span></span>, &#123;</span><br><span class="line">    <span class="attr">constructor</span>: &#123;</span><br><span class="line">        <span class="attr">value</span>: B,</span><br><span class="line">        <span class="attr">enumerable</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">writable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">configurable</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">name</span>: &#123;</span><br><span class="line">        <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> sup = B.<span class="property"><span class="keyword">prototype</span></span>, desc;</span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                sup = <span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(sup);</span><br><span class="line">                <span class="keyword">if</span> (!sup) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                desc = <span class="title class_">Object</span>.<span class="title function_">getOwnPropertyDescriptor</span>(sup, <span class="string">&#x27;name&#x27;</span>);</span><br><span class="line">            &#125; <span class="keyword">while</span>(!desc);</span><br><span class="line">           </span><br><span class="line">            <span class="keyword">return</span> (desc ? desc.<span class="property">get</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>) : <span class="literal">undefined</span>) + <span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">configurable</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">setPrototypeOf</span>(B, A);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">new</span> <span class="title function_">A</span>().<span class="property">name</span>); <span class="comment">// =&gt; A</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">new</span> <span class="title function_">B</span>().<span class="property">name</span>); <span class="comment">// =&gt; AB</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>这里没有考虑 name 不是 getter 的情形，不过原理类似，不再冗述。</p>
</blockquote>
<p>最后我们来实现在构造方法中调用 super()。显然，实质是在 B 函数中找到函数 A，根据 *Object.setPrototypeOf(B, A)*，我们有：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">B</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(B).<span class="title function_">call</span>(<span class="variable language_">this</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们为 A 添加一个 age 构造参数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">A</span>(<span class="params">age</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">B</span>(<span class="params">age</span>) &#123;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(B).<span class="title function_">call</span>(<span class="variable language_">this</span>, age);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">A.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>, &#123;</span><br><span class="line">    <span class="attr">constructor</span>: &#123;</span><br><span class="line">        <span class="attr">value</span>: A,</span><br><span class="line">        <span class="attr">enumerable</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">writable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">configurable</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">name</span>: &#123;</span><br><span class="line">        <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">configurable</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">B.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(A.<span class="property"><span class="keyword">prototype</span></span>, &#123;</span><br><span class="line">    <span class="attr">constructor</span>: &#123;</span><br><span class="line">        <span class="attr">value</span>: B,</span><br><span class="line">        <span class="attr">enumerable</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">writable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">configurable</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">name</span>: &#123;</span><br><span class="line">        <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> sup = B.<span class="property"><span class="keyword">prototype</span></span>, desc;</span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                sup = <span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(sup);</span><br><span class="line">                <span class="keyword">if</span> (!sup) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                desc = <span class="title class_">Object</span>.<span class="title function_">getOwnPropertyDescriptor</span>(sup, <span class="string">&#x27;name&#x27;</span>);</span><br><span class="line">            &#125; <span class="keyword">while</span>(!desc);</span><br><span class="line">           </span><br><span class="line">            <span class="keyword">return</span> (desc ? desc.<span class="property">get</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>) : <span class="literal">undefined</span>) + <span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">configurable</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">setPrototypeOf</span>(B, A);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">new</span> <span class="title function_">B</span>(<span class="number">18</span>).<span class="property">age</span>); <span class="comment">// =&gt; 18</span></span><br></pre></td></tr></table></figure>

<p>于是，一个基本的继承的手写版本就实现了，当然，babel 还考虑了更多细节，比如构造方法有返回值的情况等等，但基本的继承原理就是这个样子。</p>
<p>下图很好地反应了诸多对象的关系。值得一提的是， <em>b</em> 也可能成为下一级类的 prototype，你可以清晰地看到通过 __proto__ 搜索原型链的轨迹。</p>
<p><img src="/images/inherits/inherit.jpg" alt="js-inherit"></p>
<hr>
<p>在现代浏览器的不断迭代下，已经有大部分版本都实现了对 class 关键字和继承的原生支持，相信在不久的将来，就无需在这么麻烦地实现继承了。无论如何，JavaScript 继承的原理仍然是不变的，上面这些内容有助于理解原型链是怎么样工作的。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://yanni4night.github.io/2018/02/06/2018-02-07-js-inherits/" data-id="cl1ul7d6v002vjc2v9s9s0c45" data-title="JavaScript 中继承的实现" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2018-02-06-is-plainobject" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/02/06/2018-02-06-is-plainobject/" class="article-date">
  <time class="dt-published" datetime="2018-02-05T23:21:44.000Z" itemprop="datePublished">2018-02-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/js/">js</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/02/06/2018-02-06-is-plainobject/">isPlainObject 的不同实现</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>开头一个问题是：什么是 <code>Plain Object</code>？</p>
<p>并没有看到有官方去专门定义它，更可能它只不过是业界的一种通俗叫法，因此也没有严格的定义。但我们在汉语环境里通常叫它“纯对象”。</p>
<blockquote>
<p>业界解释：<a target="_blank" rel="noopener" href="https://www.quora.com/What-is-a-plainObject-in-JavaScript">https://www.quora.com/What-is-a-plainObject-in-JavaScript</a></p>
</blockquote>
<p>下面我们来看一下常见 Library 对 <em>isPlainObject</em> 函数的实现。</p>
<h2 id="jQuery"><a href="#jQuery" class="headerlink" title="jQuery"></a>jQuery</h2><p>jQuery 3.3 版本中的 <em>isPlainObject</em> 定义在<a target="_blank" rel="noopener" href="https://github.com/jquery/jquery/blob/3.3.0/src/core.js#L208">这里</a>。</p>
<p>为便于阅读，核心代码经过整理后如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">isPlainObject</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> proto, <span class="title class_">Ctor</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// (1) null 肯定不是 Plain Object</span></span><br><span class="line">    <span class="comment">// (2) 使用 Object.property.toString 排除部分宿主对象，比如 window、navigator、global</span></span><br><span class="line">    <span class="keyword">if</span> (!obj || (&#123;&#125;).<span class="property">toString</span>.<span class="title function_">call</span>(obj) !== <span class="string">&quot;[object Object]&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    proto = <span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(obj);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 只有从用 &#123;&#125; 字面量和 new Object 构造的对象，它的原型链才是 null</span></span><br><span class="line">    <span class="keyword">if</span> (!proto) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// (1) 如果 constructor 是对象的一个自有属性，则 Ctor 为 true，函数最后返回 false</span></span><br><span class="line">    <span class="comment">// (2) Function.prototype.toString 无法自定义，以此来判断是同一个内置函数</span></span><br><span class="line">    <span class="title class_">Ctor</span> = (&#123;&#125;).<span class="property">hasOwnProperty</span>.<span class="title function_">call</span>(proto, <span class="string">&quot;constructor&quot;</span>) &amp;&amp; proto.<span class="property">constructor</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> <span class="title class_">Ctor</span> === <span class="string">&quot;function&quot;</span> &amp;&amp; <span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(<span class="title class_">Ctor</span>) === <span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(<span class="title class_">Object</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="lodash"><a href="#lodash" class="headerlink" title="lodash"></a>lodash</h2><p>lodash 4.0.6 版本中的 <em>isPlainObject</em> 定义在<a target="_blank" rel="noopener" href="https://github.com/lodash/lodash/blob/4.0.6-npm-packages/lodash.isplainobject/index.js#L125">这里</a>。</p>
<p>基本与 jQuery 版本相同，多了一个 <em>Ctor instanceof Ctor</em> 的条件，满足此条件的仅有 <em>Function</em> 和 <em>Object</em> 两个函数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">isPlainObject</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!value || <span class="keyword">typeof</span> value !== <span class="string">&#x27;object&#x27;</span> || (&#123;&#125;).<span class="property">toString</span>.<span class="title function_">call</span>(value) != <span class="string">&#x27;[object Object]&#x27;</span> ) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> proto = <span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(value);</span><br><span class="line">    <span class="keyword">if</span> (proto === <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">Ctor</span> = hasOwnProperty.<span class="title function_">call</span>(proto, <span class="string">&#x27;constructor&#x27;</span>) &amp;&amp; proto.<span class="property">constructor</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> <span class="title class_">Ctor</span> == <span class="string">&#x27;function&#x27;</span> &amp;&amp; <span class="title class_">Ctor</span> <span class="keyword">instanceof</span> <span class="title class_">Ctor</span> &amp;&amp; <span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(<span class="title class_">Ctor</span>) === <span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(<span class="title class_">Object</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="redux"><a href="#redux" class="headerlink" title="redux"></a>redux</h2><p>redux 从 4.0.0 开始在测试中使用了 <em>isPlainObject</em>，代码在<a target="_blank" rel="noopener" href="https://github.com/reactjs/redux/blob/v4.0.0-beta.1/src/utils/isPlainObject.js#L5">这里</a>。</p>
<p>它的实现比较简单。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">isPlainObject</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> obj !== <span class="string">&#x27;object&#x27;</span> || obj === <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> proto = obj</span><br><span class="line">  <span class="keyword">while</span> (<span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(proto) !== <span class="literal">null</span>) &#123;</span><br><span class="line">    proto = <span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(proto)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// proto = null</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(obj) === proto</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p>我们并没有一个能判断 <em>Plain Object</em> 的清晰逻辑，大概能理出来的思路是：</p>
<ol>
<li>先判断 obj 本身是否满足我们熟悉的合法对象概念；</li>
<li>判断 obj 的构造函数是不是 Object</li>
</ol>
<p>至于判断 prototype 是不是 null，无非是一种 shortcut 罢了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://yanni4night.github.io/2018/02/06/2018-02-06-is-plainobject/" data-id="cl1ul7d6u002ujc2vcu0d9iuf" data-title="isPlainObject 的不同实现" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2018-01-13-outlook" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/01/13/2018-01-13-outlook/" class="article-date">
  <time class="dt-published" datetime="2018-01-13T13:23:40.000Z" itemprop="datePublished">2018-01-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/other/">other</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/01/13/2018-01-13-outlook/">2018 新年伊始·技术·工作</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>已经不关注社区有大半年了，或者起码有一年了，毕竟被持续增长的业务缠了也有一年了，虽然很“充实”，但毫无疑问地说，也是一无所获。</p>
<p>因为这一年来始终在 <code>React Naitve</code> 体系上工作，传统 Web 的知识也忘得大半了。还记得去年专门写过一篇<a target="_blank" rel="noopener" href="http://www.infoq.com/cn/articles/2016-review-frontend">文章</a>来总结2016年前端社区的现状，一年过去了，如果我不是特别孤陋寡闻的话，那么，我认为，现状并没有改变多少。</p>
<h2 id="框架"><a href="#框架" class="headerlink" title="框架"></a>框架</h2><h3 id="React"><a href="#React" class="headerlink" title="React"></a><a target="_blank" rel="noopener" href="https://reactjs.org/">React</a></h3><p>React 经历了一次许可证的“惊心动魄”，虽然新版本的许可证已经是安全的，但有一定研发实力的公司都已经在造自己的轮子。当然，从开发者的角度，肯定是使用成熟的方案更舒服，显然近在咫尺的理想也不见得能容易实现。</p>
<p>React 16 启用了新的引擎，这些细节是值得玩味的。</p>
<p>除此之外，React 依然拥有大量的开发者用户，就像去年一样。</p>
<h3 id="Angular"><a href="#Angular" class="headerlink" title="Angular"></a><a target="_blank" rel="noopener" href="https://angular.io/">Angular</a></h3><p>未曾想到的是，Angular 2 还立足未稳，Angular 4 就出现了。刚刚看到一篇文章，作者抱怨自己的项目使用了 Angular 2 的 beta 开发之后，暂且不表 TypeScript 语法的绑定，光是要快速 follow 短时间内几十个版本的升级就已经相当心累了。</p>
<p>当然你可以说这位开发者在一开始就不应该使用 beta 版本，但是要等到正式版本发布的话，究竟是什么时候呢？我还记得 Angular 2 的核心包去掉了 <em>beta</em> 后缀的时候，其官方维护的一众功能包，比如动画等等，依旧是在 <em>alpha&#x2F;beta</em> 状态。好吧，即使等到所有包都达到了起码的 stable 状态，Angular 4 的出现又是几个意思呢？</p>
<p>可以预见，Angular 1 时代的用户，相当一部分会放弃继续使用 Angular 的升级版本。曾经也一味推崇 Angular 2 的我，也渐渐失去了耐心。说到底，还是 Angular 的开发团队自己玩死的。</p>
<h3 id="Vue"><a href="#Vue" class="headerlink" title="Vue"></a><a target="_blank" rel="noopener" href="https://vuejs.org/v2/guide/">Vue</a></h3><p>其实去年的这个时候，我是比较看衰 Vue 的，语法不喜欢、个人维护难以为继，和 React、Angular 甚至 <a target="_blank" rel="noopener" href="https://www.emberjs.com/">Ember</a> 完全没法比。</p>
<p>不过 Vue.js 的流行程度经过这一年来，毫无减弱的趋势，我想至少有一下几方面原因：</p>
<ol>
<li>稳定，用户不必在业务迭代的同时，额外烦恼于持续升级基础框架；</li>
<li>简单，上手容易，具有普通开发经验的人，也可以在十分钟内写出一个较为复杂的应用；</li>
<li>生态工具较为丰富，特别是重要工具由作者维护，质量有保证且唯一，不用担心选择恐惧症</li>
</ol>
<p>说白了，对于真正的业务开发环境，稳定和简单是特别重要的两个特性，不求能有多激进的特性，但求省心。</p>
<p>另外，Vue 的 ssr 方面也有足够的能力和性能支持，这在今天的 web 应用中，还是比较有吸引力的。React 生态也仅有一个简单的 <a target="_blank" rel="noopener" href="https://github.com/zeit/next.js/">next.js</a> 还算勉强能用，而 Angular 和 Ember 基本都属于残次品。</p>
<h3 id="Ember"><a href="#Ember" class="headerlink" title="Ember"></a>Ember</h3><p>Ember 属于比较小众的框架，我已经关注它有两年了，毕竟推广不多，很多人不知道，社区发展也有限。过去这一年依旧表现平平。</p>
<h3 id="React-Native"><a href="#React-Native" class="headerlink" title="React-Native"></a>React-Native</h3><p>如果说去年上半年我起码还在 <code>React Native</code> 上积累了点经验的话，那么下半年基本就达到了瓶颈了。许可证是一方面，公司环境是另一方面，但这都不重要。重要的是，我依旧不看好这个东西。</p>
<p>“行百里者半九十”，我们已经写了成千上万行代码，过亿的用户，以及良好的开发上线流程，但依旧避免不了要时刻面对框架底层缺陷带给我们的额外工作量与业务损失。作为前端开发者，过去面对浏览器兼容性起码还有前辈多年的经验积累，但 <code>React Native</code> 带给我们的就是大大提升了自身的技术钻研能力。</p>
<h2 id="工程化"><a href="#工程化" class="headerlink" title="工程化"></a>工程化</h2><h3 id="Webpack"><a href="#Webpack" class="headerlink" title="Webpack"></a><a target="_blank" rel="noopener" href="https://webpack.js.org/">Webpack</a></h3><p>Webpack 也从 2 升级到了3，但变化俨然远远不如从 1 到 2。使用配置难度依旧居高不下，想我这种上了年纪的人，没得商量，每次使用都要再看一遍 doc。</p>
<h3 id="Rollup"><a href="#Rollup" class="headerlink" title="Rollup"></a><a target="_blank" rel="noopener" href="https://rollupjs.org/guide/en">Rollup</a></h3><p>Rollup 的定位十分明确，与 Webpack 不构成竞争关系。写  library 用 Rollup，写 app 用 Webpack。</p>
<h3 id="npm"><a href="#npm" class="headerlink" title="npm"></a>npm</h3><p><a target="_blank" rel="noopener" href="https://jspm.io/">jspm</a>、<a target="_blank" rel="noopener" href="https://bower.io/">bower</a> 几乎已成骨灰，<a target="_blank" rel="noopener" href="https://yarnpkg.com/">yarn</a> 依旧不支持 scope。</p>
<h2 id="新方向"><a href="#新方向" class="headerlink" title="新方向"></a>新方向</h2><h3 id="webassembly"><a href="#webassembly" class="headerlink" title="webassembly"></a><a target="_blank" rel="noopener" href="http://webassembly.org/">webassembly</a></h3><p>在下一代人上小学之前能看到定稿的 webassembly 我就已经满足了。</p>
<h3 id="webcomponents"><a href="#webcomponents" class="headerlink" title="webcomponents"></a><a target="_blank" rel="noopener" href="https://www.webcomponents.org/">webcomponents</a></h3><p>在下一代人上小学之前能看到普及的 webcomponents 我就已经满足了。</p>
<h3 id="数据"><a href="#数据" class="headerlink" title="数据"></a>数据</h3><p>断断续续学习 <a target="_blank" rel="noopener" href="https://d3js.org/">D3</a>，但明显精力不如从前。</p>
<h3 id="微信小程序"><a href="#微信小程序" class="headerlink" title="微信小程序"></a>微信小程序</h3><p>如我所料，半温不火。令人鄙视的是，支付宝和百度都还在模仿，简直了。</p>
<h2 id="我的工作"><a href="#我的工作" class="headerlink" title="我的工作"></a>我的工作</h2><p>去年我还在研究一种解决方案，能够兼顾的开发效率、运行时性能这两个看似简单却互为矛盾的指标。最后确实有了一个雏形。今年，我已经不再感兴趣，没有别的，就一个原因，想的太多，跟本没有那么复杂的使用场景。</p>
<p>总体来看过去一年，对于个人来讲是毫无建树的，今年上半年，我可能需要拓展一下视野，找一找我不会做的事情做一做。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://yanni4night.github.io/2018/01/13/2018-01-13-outlook/" data-id="cl1ul7d6t002sjc2veif9ae65" data-title="2018 新年伊始·技术·工作" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2017-11-23-utf8" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/11/23/2017-11-23-utf8/" class="article-date">
  <time class="dt-published" datetime="2017-11-23T14:17:38.000Z" itemprop="datePublished">2017-11-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/encoding/">encoding</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/11/23/2017-11-23-utf8/">Unicode 如何编码成 UTF-8</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Unicode 是<strong>字符集（charset）</strong>，UTF-8、UTF-16 只是 Unicode 的编码规则（encoding）。</p>
<p>标准的 UTF-8 对 Unicode 分为4种变长的编码格式。</p>
<table>
<thead>
<tr>
<th align="center">区间</th>
<th align="center">字节数</th>
<th align="center">编码格式</th>
</tr>
</thead>
<tbody><tr>
<td align="center">0~0x7F</td>
<td align="center">1</td>
<td align="center"><font color="blue">0</font>xxxxxxx</td>
</tr>
<tr>
<td align="center">0x80~0x7FF</td>
<td align="center">2</td>
<td align="center"><font color="blue">110</font>xxxxx <font color="blue">10</font>xxxxxx</td>
</tr>
<tr>
<td align="center">0x800~0xFFFF</td>
<td align="center">3</td>
<td align="center"><font color="blue">1110</font>xxxx <font color="blue">10</font>xxxxxx <font color="blue">10</font>xxxxxx</td>
</tr>
<tr>
<td align="center">0x10000~0x10FFFF</td>
<td align="center">4</td>
<td align="center"><font color="blue">11110</font>xxx <font color="blue">10</font>xxxxxx <font color="blue">10</font>xxxxxx <font color="blue">10</font>xxxxxx</td>
</tr>
</tbody></table>
<p>也就是说，对于英文字母这种ASCII字符，UTF-8与ASCII是兼容的，都采用1字节存储。</p>
<p>对于希伯来语字母 <code>א</code>，UTF-8采用两个字节存储，方法是把它的 Unicode 码 0x05d0 的二进制形式拆成两部分，后6位前补10，再前数5位前补110，拼到一起（余下全为0），即为 0xd790。</p>
<pre>
0x05D0 = b00000<font color="red">10111</font>   <font color="red">010000</font>
            110<font color="red">10111</font> 10<font color="red">010000</font> = 0xD790
</pre>

<p>同样道理，汉字“我”采用3字节，Unicode 码拆成3部分：</p>
<pre>
0x6211 = b<font color="red">0110   001000   010001</font>
      1110<font color="red">0110</font> 10<font color="red">001000</font> 10<font color="red">010001</font> = 0xE68891
</pre>

<p>总结来看，字节起始为0则为单字节字符，起始为110、1110、11110分别代表有2个、3个、4个字节组合代表一个字符。其它字节起始必然全为10，代表不是字符起始位置。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://yanni4night.github.io/2017/11/23/2017-11-23-utf8/" data-id="cl1ul7d6s002qjc2v1z7x9xh9" data-title="Unicode 如何编码成 UTF-8" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/b70-Valkyrie/">b70 Valkyrie</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/bubble-event-jquery/">bubble event jquery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/bug/">bug</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/chrome-json-performance-resource-timing/">chrome json performance resource timing</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/css/">css</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/css3-column-layout/">css3 column layout</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/encoding/">encoding</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/engineering/">engineering</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/error-exception-throw-try-catch-%E5%BC%82%E5%B8%B8/">error exception throw try catch 异常</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/flex-box-%E5%8F%AF%E4%BC%B8%E7%BC%A9-%E5%B8%83%E5%B1%80/">flex box 可伸缩 布局</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/gitbook-plugin/">gitbook plugin</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/html/">html</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/http/">http</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/incremental-DOM-reactjs-emberjs-glimmer/">incremental DOM reactjs emberjs glimmer</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/layout/">layout</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/liqi-%E5%88%A9%E5%99%A8/">liqi 利器</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/npm/">npm</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/npm-node-semser-%E8%AF%AD%E4%B9%89%E5%8C%96%E7%89%88%E6%9C%AC/">npm node semser 语义化版本</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/performance/">performance</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/react-native/">react-native</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/reading/">reading</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/sublime-plugin/">sublime plugin</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tieba-https/">tieba https</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/webcomponents/">webcomponents</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E7%A8%8B%E5%B8%88-%E6%88%90%E9%95%BF/">工程师 成长</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%A4%BE%E5%8C%BA-%E6%8A%80%E6%9C%AF/">社区 技术</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/other/" rel="tag">other</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/other/" style="font-size: 10px;">other</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">十二月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">三月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">一月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">四月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">三月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">一月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">十一月 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">九月 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">八月 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/05/">五月 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/04/">四月 2014</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/09/21/2018-09-21-prettier-eslint/">prettier配合eslint执行自动化代码格式化</a>
          </li>
        
          <li>
            <a href="/2018/03/23/2018-03-23-principle-+/">Javascript &#39;+&#39; 运算符原理</a>
          </li>
        
          <li>
            <a href="/2018/02/27/2018-02-27-cultivating-a-paradoxical-frame-of-mind/">《咨询的奥秘》 第二章 培养矛盾的思维框架</a>
          </li>
        
          <li>
            <a href="/2018/02/19/2018-02-19-pagex/">获取元素在文档流中的位置</a>
          </li>
        
          <li>
            <a href="/2018/02/12/2018-02-12-vue-dom-diff/">Vue.js 中的 DOM Diff 算法</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 Yanni4night<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>